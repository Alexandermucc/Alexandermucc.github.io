<!DOCTYPE HTML>
<html lang="zh-CN">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="tech-mysql, Alexandermucc">
    <meta name="description" content="MySQL复习.xmind
有一个知识脉络

从一个点出发一直问为什么为什么？

数据库概述与MySQL安装篇第01章：数据库概述1 概念


DB：数据库（Database）



即存储数据的“仓库”，其本质是一个文件系统。它保存了一系">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <!-- Global site tag (gtag.js) - Google Analytics -->


    <title>tech-mysql | Alexandermucc</title>
    <link rel="icon" type="image/png" href="/favicon.png">

    <link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
    <link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
    <link rel="stylesheet" type="text/css" href="/css/matery.css">
    <link rel="stylesheet" type="text/css" href="/css/my.css">

    <script src="/libs/jquery/jquery-3.6.0.min.js"></script>

<meta name="generator" content="Hexo 6.1.0"><link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css">
<link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"><link rel="alternate" href="/atom.xml" title="Alexandermucc" type="application/atom+xml">
</head>



   <style>
    body{
       background-image: url(https://cdn.jsdelivr.net/gh/Tokisaki-Galaxy/res/site/medias/background.jpg);
       background-repeat:no-repeat;
       background-size: 100% 100%;
       background-attachment:fixed;
    }
</style>



<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/medias/logo.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">Alexandermucc</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>首页</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/tags" class="waves-effect waves-light">
      
      <i class="fas fa-tags" style="zoom: 0.6;"></i>
      
      <span>标签</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories" class="waves-effect waves-light">
      
      <i class="fas fa-bookmark" style="zoom: 0.6;"></i>
      
      <span>分类</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>归档</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>关于</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/contact" class="waves-effect waves-light">
      
      <i class="fas fa-comments" style="zoom: 0.6;"></i>
      
      <span>留言板</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/friends" class="waves-effect waves-light">
      
      <i class="fas fa-address-book" style="zoom: 0.6;"></i>
      
      <span>友情链接</span>
    </a>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="搜索" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>


<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">Alexandermucc</div>
        <div class="logo-desc">
            
            Never really desperate, only the lost of the soul.
            
        </div>
    </div>

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			首页
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/tags" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-tags"></i>
			
			标签
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-bookmark"></i>
			
			分类
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			归档
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			关于
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/contact" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-comments"></i>
			
			留言板
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/friends" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-address-book"></i>
			
			友情链接
		</a>
          
        </li>
        
        
        <li><div class="divider"></div></li>
        <li>
            <a href="https://github.com/blinkfox/hexo-theme-matery" class="waves-effect waves-light" target="_blank">
                <i class="fab fa-github-square fa-fw"></i>Fork Me
            </a>
        </li>
        
    </ul>
</div>


        </div>

        
            <style>
    .nav-transparent .github-corner {
        display: none !important;
    }

    .github-corner {
        position: absolute;
        z-index: 10;
        top: 0;
        right: 0;
        border: 0;
        transform: scale(1.1);
    }

    .github-corner svg {
        color: #0f9d58;
        fill: #fff;
        height: 64px;
        width: 64px;
    }

    .github-corner:hover .octo-arm {
        animation: a 0.56s ease-in-out;
    }

    .github-corner .octo-arm {
        animation: none;
    }

    @keyframes a {
        0%,
        to {
            transform: rotate(0);
        }
        20%,
        60% {
            transform: rotate(-25deg);
        }
        40%,
        80% {
            transform: rotate(10deg);
        }
    }
</style>

<a href="https://github.com/blinkfox/hexo-theme-matery" class="github-corner tooltipped hide-on-med-and-down" target="_blank"
   data-tooltip="Fork Me" data-position="left" data-delay="50">
    <svg viewBox="0 0 250 250" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
              fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
              fill="currentColor" class="octo-body"></path>
    </svg>
</a>
        
    </nav>

</header>

    
<script src="/libs/cryptojs/crypto-js.min.js"></script>
<script>
    (function() {
        let pwd = '';
        if (pwd && pwd.length > 0) {
            if (pwd !== CryptoJS.SHA256(prompt('请输入访问本文章的密码')).toString(CryptoJS.enc.Hex)) {
                alert('密码错误，将返回主页！');
                location.href = '/';
            }
        }
    })();
</script>




<div class="bg-cover pd-header post-cover" style="background-image: url('/medias/featureimages/19.jpg')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">tech-mysql</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
<style>
    #articleContent h1::before,
    #articleContent h2::before,
    #articleContent h3::before,
    #articleContent h4::before,
    #articleContent h5::before,
    #articleContent h6::before {
        display: block;
        content: " ";
        height: 100px;
        margin-top: -100px;
        visibility: hidden;
    }

    #articleContent :focus {
        outline: none;
    }

    .toc-fixed {
        position: fixed;
        top: 64px;
    }

    .toc-widget {
        width: 345px;
        padding-left: 20px;
    }

    .toc-widget .toc-title {
        padding: 35px 0 15px 17px;
        font-size: 1.5rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    .toc-widget ol {
        padding: 0;
        list-style: none;
    }

    #toc-content {
        padding-bottom: 30px;
        overflow: auto;
    }

    #toc-content ol {
        padding-left: 10px;
    }

    #toc-content ol li {
        padding-left: 10px;
    }

    #toc-content .toc-link:hover {
        color: #42b983;
        font-weight: 700;
        text-decoration: underline;
    }

    #toc-content .toc-link::before {
        background-color: transparent;
        max-height: 25px;

        position: absolute;
        right: 23.5vw;
        display: block;
    }

    #toc-content .is-active-link {
        color: #42b983;
    }

    #floating-toc-btn {
        position: fixed;
        right: 15px;
        bottom: 76px;
        padding-top: 15px;
        margin-bottom: 0;
        z-index: 998;
    }

    #floating-toc-btn .btn-floating {
        width: 48px;
        height: 48px;
    }

    #floating-toc-btn .btn-floating i {
        line-height: 48px;
        font-size: 1.4rem;
    }
</style>
<div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/tags/MySQL/">
                                <span class="chip bg-color">MySQL</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                    <div class="post-cate">
                        <i class="fas fa-bookmark fa-fw icon-category"></i>
                        
                            <a href="/categories/technique/" class="post-category">
                                technique
                            </a>
                        
                    </div>
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>发布日期:&nbsp;&nbsp;
                    2022-03-28
                </div>
                

                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-check fa-fw"></i>更新日期:&nbsp;&nbsp;
                    2022-03-28
                </div>
                

                
                <div class="info-break-policy">
                    <i class="far fa-file-word fa-fw"></i>文章字数:&nbsp;&nbsp;
                    17.4k
                </div>
                

                
                <div class="info-break-policy">
                    <i class="far fa-clock fa-fw"></i>阅读时长:&nbsp;&nbsp;
                    69 分
                </div>
                

                
                    <div id="busuanzi_container_page_pv" class="info-break-policy">
                        <i class="far fa-eye fa-fw"></i>阅读次数:&nbsp;&nbsp;
                        <span id="busuanzi_value_page_pv"></span>
                    </div>
				
            </div>
        </div>
        <hr class="clearfix">

        

        

        <div class="card-content article-card-content">
            <div id="articleContent">
                <p><a target="_blank" rel="noopener" href="https://www.yuque.com/attachments/yuque/0/2021/xmind/2040418/1637572388832-c5f0cb79-6606-4d7b-98be-528e37cfbf10.xmind">MySQL复习.xmind</a></p>
<p>有一个知识脉络</p>
<p><img src="https://cdn.nlark.com/yuque/0/2021/jpeg/2040418/1637135392517-f59e7783-72c5-465f-a136-1a1ae7bc7040.jpeg" alt="img"></p>
<p>从一个点出发一直问为什么为什么？</p>
<hr>
<h1 id="数据库概述与MySQL安装篇"><a href="#数据库概述与MySQL安装篇" class="headerlink" title="数据库概述与MySQL安装篇"></a>数据库概述与MySQL安装篇</h1><h2 id="第01章：数据库概述"><a href="#第01章：数据库概述" class="headerlink" title="第01章：数据库概述"></a>第01章：数据库概述</h2><h3 id="1-概念"><a href="#1-概念" class="headerlink" title="1 概念"></a>1 概念</h3><table>
<thead>
<tr>
<th><strong>DB：数据库（Database）</strong></th>
</tr>
</thead>
<tbody><tr>
<td>即存储数据的“仓库”，其本质是一个文件系统。它保存了一系列有组织的数据。</td>
</tr>
<tr>
<td><strong>DBMS：数据库管理系统（Database Management System）</strong></td>
</tr>
<tr>
<td>是一种操纵和管理数据库的大型软件，用于建立、使用和维护数据库，对数据库进行统一管理和控 制。用户通过数据库管理系统访问数据库中表内的数据。</td>
</tr>
<tr>
<td><strong>SQL：结构化查询语言（Structured Query Language）</strong></td>
</tr>
<tr>
<td>专门用来与数据库通信的语言。</td>
</tr>
</tbody></table>
<h4 id="RDBMS-关系型数据库"><a href="#RDBMS-关系型数据库" class="headerlink" title="RDBMS : 关系型数据库"></a>RDBMS : 关系型数据库</h4><p>关系型数据库模型是把复杂的数据结构归结为简单的<br>二元关系 （即二维表格形式） </p>
<p>行(row) 和 列(column) 的形式存储数据，以便于用户理解。</p>
<p><strong>优势</strong></p>
<ul>
<li>复杂查询 可以用SQL语句方便的在一个表以及多个表之间做非常复杂的数据查询。</li>
<li>事务支持 使得对于安全性能很高的数据访问要求得以实现</li>
</ul>
<h4 id="非关系型数据库"><a href="#非关系型数据库" class="headerlink" title="非关系型数据库"></a>非关系型数据库</h4><p>可看成传统关系型数据库的功能 <strong>阉割版本</strong> ，基于键值对存储数据，不需要经过SQL层的解析， <strong>性能非常高</strong> 。同时，通过减少不常用的功能，进一步提高性能 </p>
<p><strong>类别</strong></p>
<ol>
<li><strong>键值型数据库</strong></li>
</ol>
<p>键值型数据库典型的使用场景是作为 内存缓存 。</p>
<p>Redis 是最流行的键值型数据库 </p>
<ol>
<li><strong>文档型数据库</strong></li>
</ol>
<p>此类数据库可存放并获取文档，可以是XML、JSON等格式 </p>
<p>MongoDB是最流行的文档型数据库 </p>
<ol>
<li><strong>搜索引擎数据库</strong></li>
</ol>
<p>虽然关系型数据库采用了索引提升检索效率，但是针对全文索引效率却较低。搜索引擎数据库是应用在搜索引擎领域的数据存储形式，由于搜索引擎会爬取大量的数据，并以特定的格式进行存储，这样在检索的时候才能保证性能最优。核心原理是“倒排索引”。</p>
<p>典型产品：Solr、Elasticsearch、Splunk 等  </p>
<ol>
<li><strong>列式数据库</strong></li>
</ol>
<p>列式数据库是将数据按照列存储到数据库中，这样做的好处是可以大量降低系统的I&#x2F;O，适合于分布式文件系统，不足在于功能相对有限。</p>
<p>典型产品：HBase等 </p>
<ol>
<li><strong>图形数据库</strong></li>
</ol>
<p>利用了图这种数据结构存储了实体（对象）之间的关系 </p>
<p>典型产品：Neo4J、InfoGrid等。 </p>
<h3 id="2-MySQL"><a href="#2-MySQL" class="headerlink" title="2 MySQL"></a>2 MySQL</h3><ul>
<li>MySQL是一个 开放源代码的关系型数据库管理系统</li>
<li>MySQL使用 标准的SQL数据语言 形式</li>
</ul>
<p>MySQL 由于其<strong>体积小、速度快、总体拥有成本低，可处理上千万条记录的大型数据库</strong>，尤其是开放源码这一特点，使得很多互联网公司、中小型网站选择了MySQL作为网站数据库（Facebook，Twitter，YouTube，阿里巴巴&#x2F;蚂蚁金服，去哪儿，美团外卖，腾讯）。 </p>
<h3 id="3-关系型数据库设计规则"><a href="#3-关系型数据库设计规则" class="headerlink" title="3. 关系型数据库设计规则"></a>3. 关系型数据库设计规则</h3><p><strong>ORM</strong>（object Relational Mapping）体现</p>
<p>数据库中的<strong>表</strong> 对应 Java中的类</p>
<p>数据库中的对象 对应 Java中类的实体（对象）</p>
<p>数据库中的一个列 对应 Java中类的一个字段</p>
<h4 id="3-1-表的关联关系"><a href="#3-1-表的关联关系" class="headerlink" title="3.1 表的关联关系"></a>3.1 表的关联关系</h4><p>四种：一对一关联、一对多关联、多对多关联、自我引用 </p>
<p><strong>自我引用</strong></p>
<p><img src="https://cdn.nlark.com/yuque/0/2021/png/2040418/1637136448325-a5edcf88-f519-4065-9954-53192fe750e8.png" alt="img"></p>
<h2 id="第02章：MySQL环境搭建"><a href="#第02章：MySQL环境搭建" class="headerlink" title="第02章：MySQL环境搭建"></a>第02章：MySQL环境搭建</h2><h3 id="卸载"><a href="#卸载" class="headerlink" title="卸载"></a>卸载</h3><h4 id="步骤1：停止MySQL服务"><a href="#步骤1：停止MySQL服务" class="headerlink" title="步骤1：停止MySQL服务"></a>步骤1：停止MySQL服务</h4><p>在卸载之前，先停止MySQL8.0的服务。按键盘上的“Ctrl + Alt + Delete”组合键，打开“任务管理器”对话<br>框，可以在“服务”列表找到“MySQL8.0”的服务，如果现在“正在运行”状态，可以右键单击服务，选择“停<br>止”选项停止MySQL8.0的服务，如图所示。</p>
<h4 id="步骤2：软件的卸载"><a href="#步骤2：软件的卸载" class="headerlink" title="步骤2：软件的卸载"></a>步骤2：软件的卸载</h4><ul>
<li><p>方式1：通过控制面板方式<br>卸载MySQL8.0的程序可以和其他桌面应用程序一样直接在“控制面板”选择“卸载程序”，并在程序列表中<br>找到MySQL8.0服务器程序，直接双击卸载即可，如图所示。这种方式删除，数据目录下的数据不会跟着<br>删除。</p>
</li>
<li><p>方式2：通过360或电脑管家等软件卸载<br>略</p>
</li>
<li><p>方式3：通过安装包提供的卸载功能卸载<br>你也可以通过安装向导程序进行MySQL8.0服务器程序的卸载。<br>① 再次双击下载的mysql-installer-community-8.0.26.0.msi文件，打开安装向导。安装向导会自动检测已<br>安装的MySQL服务器程序。<br>② 选择要卸载的MySQL服务器程序，单击“Remove”（移除），即可进行卸载。</p>
</li>
</ul>
<h4 id="步骤3：残余文件的清理"><a href="#步骤3：残余文件的清理" class="headerlink" title="步骤3：残余文件的清理"></a>步骤3：残余文件的清理</h4><p>如果再次安装不成功，可以卸载后对残余文件进行清理后再安装。<br>（1）服务目录：mysql服务的安装目录<br>（2）数据目录：默认在C:\ProgramData\MySQL<br>如果自己单独指定过数据目录，就找到自己的数据目录进行删除即可 </p>
<p><strong>注意：请在卸载前做好数据备份</strong></p>
<p>在操作完以后，需要重启计算机，然后进行安装即可。如果仍然安装失败，需要继续操作如下步骤4。 </p>
<h4 id="步骤4：清理注册表（选做）5-7版本"><a href="#步骤4：清理注册表（选做）5-7版本" class="headerlink" title="步骤4：清理注册表（选做）5.7版本"></a>步骤4：清理注册表（选做）5.7版本</h4><p>如果前几步做了，再次安装还是失败，那么可以清理注册表。<br>如何打开注册表编辑器：在系统的搜索框中输入 regedit </p>
<pre class="line-numbers language-java"><code class="language-java">HKEY_LOCAL_MACHINE\SYSTEM\ControlSet001\Services\MySQL服务 目录删除
HKEY_LOCAL_MACHINE\SYSTEM\ControlSet002\Services\Eventlog\Application\MySQL服务 目录删除
HKEY_LOCAL_MACHINE\SYSTEM\ControlSet002\Services\MySQL服务 目录删除
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Eventlog\Application\MySQL服务目录
删除
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\MySQL服务删除
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>注册表中的ControlSet001,ControlSet002,不一定是001和002,可能是ControlSet005、006之类 </p>
<h4 id="步骤5：删除环境变量配置"><a href="#步骤5：删除环境变量配置" class="headerlink" title="步骤5：删除环境变量配置"></a>步骤5：删除环境变量配置</h4><p>找到path环境变量，将其中关于mysql的环境变量删除，切记不要全部删除。 </p>
<h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><ul>
<li><p><strong>MySQL Community Server 社区版本</strong>，开源免费，自由下载，但不提供官方技术支持，适用于大多数普通用户。</p>
</li>
<li><p><strong>MySQL Enterprise Edition 企业版本</strong>，需付费，不能在线下载，可以试用30天。提供了更多的功能和更完备的技术支持，更适合于对数据库的功能和可靠性要求较高的企业客户。</p>
</li>
<li><p><strong>MySQL Cluster 集群版</strong>，开源免费。用于架设集群服务器，可将几个MySQL Server封装成一个Server。需要在社区版或企业版的基础上使用。</p>
</li>
<li><p><strong>MySQL Cluster CGE 高级集群版</strong>，需付费。</p>
</li>
</ul>
<p>此外，官方还提供了 <strong>MySQL Workbench</strong> （GUITOOL）一款专为MySQL设计的 <strong>图形界面管理</strong>工具 。<br>MySQLWorkbench又分为两个版本，分别是 社区版 （MySQL Workbench OSS）、 商用版 （MySQL WorkbenchSE）。 </p>
<h4 id="1-下载地址"><a href="#1-下载地址" class="headerlink" title="1. 下载地址"></a>1. 下载地址</h4><p>官网：<a target="_blank" rel="noopener" href="https://www.mysql.com/">https://www.mysql.com</a></p>
<h4 id="2-打开官网，点击DOWNLOADS"><a href="#2-打开官网，点击DOWNLOADS" class="headerlink" title="2. 打开官网，点击DOWNLOADS"></a>2. 打开官网，点击DOWNLOADS</h4><p>然后，点击 MySQL Community(GPL) Downloads<br> <img src="https://cdn.nlark.com/yuque/0/2021/png/2040418/1637137506630-94cbba54-74b4-4b7c-9c73-b24f825df745.png" alt="img"></p>
<h4 id="3-点击-MySQL-Community-Server"><a href="#3-点击-MySQL-Community-Server" class="headerlink" title="3. 点击 MySQL Community Server   "></a>3. 点击 MySQL Community Server   <img src="https://cdn.nlark.com/yuque/0/2021/png/2040418/1637137534083-3371d647-633f-4f84-bda7-c8ae64592e91.png" alt="img"></h4><h4 id="4-在General-Availability-GA-Releases中选择适合的版本"><a href="#4-在General-Availability-GA-Releases中选择适合的版本" class="headerlink" title="4. 在General Availability(GA) Releases中选择适合的版本"></a>4. 在General Availability(GA) Releases中选择适合的版本</h4><p>Windows平台下提供两种安装文件：MySQL二进制分发版（.msi安装文件）和免安装版（.zip压缩文件）。一般来讲，应当使用二进制分发版，因为该版本提供了图形化的安装向导过程，比其他的分发版使用起来要简单，不再需要其他工具启动就可以运行MySQL。 </p>
<p>这里在Windows 系统下推荐下载 <strong>MSI</strong>安装程序 ；点击 Go to Download Page 进行下载即可 </p>
<p><img src="https://cdn.nlark.com/yuque/0/2021/png/2040418/1637137586393-0d005581-abb2-4e86-a411-99d941a903ba.png" alt="img"></p>
<p><img src="https://cdn.nlark.com/yuque/0/2021/png/2040418/1637137636416-3c4f247d-33b7-44fb-872b-c0a39015821f.png" alt="img"></p>
<ul>
<li><p>Windows下的MySQL8.0安装有两种安装程序</p>
</li>
<li><ul>
<li>mysql-installer-web-community-8.0.26.0.msi 下载程序大小：2.4M；安装时需要联网安装组件。</li>
<li>mysql-installer-community-8.0.26.0.msi 下载程序大小：450.7M；安装时离线安装即可。推荐</li>
</ul>
</li>
<li><p>具体细节可查看如下pdf文档</p>
</li>
</ul>
<p><a target="_blank" rel="noopener" href="https://www.yuque.com/attachments/yuque/0/2021/pdf/2040418/1637138642358-3b91f633-396d-47dc-801d-9df41f9a5d6b.pdf">第02章_MySQL环境搭建.pdf</a></p>
<h2 id="mysql-命令行使用"><a href="#mysql-命令行使用" class="headerlink" title="mysql 命令行使用"></a>mysql 命令行使用</h2><h3 id="安装完成后可通过命令访问"><a href="#安装完成后可通过命令访问" class="headerlink" title="安装完成后可通过命令访问"></a>安装完成后可通过命令访问</h3><pre class="line-numbers language-plain"><code class="language-plain">mysql -uroot -p1234 -hlocalhost -P3306
mysql -uroot -p1234 -hlocalhost -P13306
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h3 id="打开关闭服务"><a href="#打开关闭服务" class="headerlink" title="打开关闭服务"></a>打开关闭服务</h3><pre class="line-numbers language-plain"><code class="language-plain">net stop mysql57
net start mysql57
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h3 id="查看编码命令"><a href="#查看编码命令" class="headerlink" title="查看编码命令"></a>查看编码命令</h3><pre class="line-numbers language-plain"><code class="language-plain">show variables like 'character_%';
show variables like 'collation_%';
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h1 id="SQL之SELECT使用篇"><a href="#SQL之SELECT使用篇" class="headerlink" title="SQL之SELECT使用篇"></a>SQL之SELECT使用篇</h1><h2 id="SQL语句规则和规范"><a href="#SQL语句规则和规范" class="headerlink" title="SQL语句规则和规范"></a>SQL语句规则和规范</h2><h3 id="基本规则"><a href="#基本规则" class="headerlink" title="基本规则"></a>基本规则</h3><ul>
<li><p>SQL 可以写在一行或者多行。为了提高可读性，各子句分行写，必要时使用缩进</p>
</li>
<li><p>每条命令以 ; 或 \g 或 \G 结束</p>
</li>
<li><p>关键字不能被缩写也不能分行</p>
</li>
<li><ul>
<li>关于标点符号</li>
<li>必须保证所有的()、单引号、双引号是成对结束的</li>
</ul>
</li>
<li><ul>
<li>必须使用英文状态下的半角输入方式</li>
<li>字符串型和日期时间类型的数据可以使用单引号（’ ‘）表示</li>
</ul>
</li>
<li><ul>
<li>列的别名，尽量使用双引号（” “），而且不建议省略as</li>
</ul>
</li>
</ul>
<h3 id="SQL大小写规范-（建议遵守）"><a href="#SQL大小写规范-（建议遵守）" class="headerlink" title="SQL大小写规范 （建议遵守）"></a>SQL大小写规范 （建议遵守）</h3><ul>
<li><p>MySQL 在 Windows 环境下是大小写不敏感的</p>
</li>
<li><p>MySQL 在 Linux 环境下是大小写敏感的</p>
</li>
<li><ul>
<li>数据库名、表名、表的别名、变量名是严格区分大小写的</li>
<li>关键字、函数名、列名(或字段名)、列的别名(字段的别名) 是忽略大小写的。</li>
</ul>
</li>
<li><p>推荐采用统一的书写规范：</p>
</li>
<li><ul>
<li>数据库名、表名、表别名、字段名、字段别名等都小写</li>
<li>SQL 关键字、函数名、绑定变量等都大写</li>
</ul>
</li>
</ul>
<h3 id="注释"><a href="#注释" class="headerlink" title="注释"></a>注释</h3><pre class="line-numbers language-sql"><code class="language-sql">行注释：<span class="token comment" spellcheck="true">#注释文字(MySQL特有的方式)</span>
单行注释：<span class="token comment" spellcheck="true">-- 注释文字(--后面必须包含一个空格。)</span>
多行注释：<span class="token comment" spellcheck="true">/* 注释文字 */</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<h3 id="数据导入指令"><a href="#数据导入指令" class="headerlink" title="数据导入指令"></a>数据导入指令</h3><pre class="line-numbers language-sql"><code class="language-sql">mysql<span class="token operator">></span> source <span class="token number">d</span>:\mysqldb<span class="token punctuation">.</span>sql
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="第03章：基本的SELECT语句"><a href="#第03章：基本的SELECT语句" class="headerlink" title="第03章：基本的SELECT语句"></a>第03章：基本的SELECT语句</h3><h4 id="列的别名"><a href="#列的别名" class="headerlink" title="列的别名"></a>列的别名</h4><p>重命名一个列，便于计算 </p>
<ul>
<li>as：全称alias（别名），可省略</li>
<li>可以用<code>&quot;&quot;</code>引用</li>
</ul>
<h4 id="去除重复行"><a href="#去除重复行" class="headerlink" title="去除重复行"></a>去除重复行</h4><p><code>distinct</code>关键字</p>
<h4 id="空值参与运算"><a href="#空值参与运算" class="headerlink" title="空值参与运算"></a>空值参与运算</h4><p>可以使用 <code>IFNULL</code> 用来替换</p>
<h4 id="着重号"><a href="#着重号" class="headerlink" title="着重号"></a>着重号</h4><p>`&#96;&#96;&#96;用来区别于关键字</p>
<h4 id="查询常数"><a href="#查询常数" class="headerlink" title="查询常数"></a>查询常数</h4><p>会将常数在列中都显示</p>
<p><img src="https://cdn.nlark.com/yuque/0/2021/png/2040418/1637153799826-5e60e016-14d5-4ac5-b742-26c7b4fe6f2c.png" alt="img"></p>
<h4 id="显示表结构"><a href="#显示表结构" class="headerlink" title="显示表结构"></a>显示表结构</h4><pre><code>describe`或者`desc
</code></pre>
<h4 id="过滤数据"><a href="#过滤数据" class="headerlink" title="过滤数据"></a>过滤数据</h4><p><code>where</code> 后接条件判断</p>
<h2 id="第04章：运算符"><a href="#第04章：运算符" class="headerlink" title="第04章：运算符"></a>第04章：运算符</h2><h3 id="1-算术运算符"><a href="#1-算术运算符" class="headerlink" title="1. 算术运算符"></a>1. 算术运算符</h3><p>算术运算符主要用于数学运算，其可以连接运算符前后的两个数值或表达式，对数值或表达式进行加（+）、减（-）、乘（*）、除（&#x2F;）和取模（%）运算。 </p>
<p><img src="https://cdn.nlark.com/yuque/0/2021/png/2040418/1637212130325-a222af8c-c67d-4c42-bd04-d7bb9035aaee.png" alt="img"></p>
<h3 id="2-比较运算符"><a href="#2-比较运算符" class="headerlink" title="2. 比较运算符"></a>2. 比较运算符</h3><p>对表达式左边的操作数和右边的操作数进行比较，比较的结果为真则返回1，比较的结果为假则返回0，其他情况则返回NULL。<br> <img src="https://cdn.nlark.com/yuque/0/2021/png/2040418/1637212175268-df2895de-e980-4e14-96cc-6c00773089a5.png" alt="img"></p>
<p><strong>安全等于运算符</strong> </p>
<p>安全等于运算符（&lt;&#x3D;&gt;）与等于运算符（&#x3D;）的作用是相似的， 唯一的区别 是‘&lt;&#x3D;&gt;’可以用来对NULL进行判断。在两个操作数均为NULL时，其返回值为1，而不为NULL；当一个操作数为<code>NULL</code>时，其返回值为0，而不为NULL 。</p>
<hr>
<h4 id="非符号类型的运算符"><a href="#非符号类型的运算符" class="headerlink" title="非符号类型的运算符"></a>非符号类型的运算符</h4><p>【is null】 【isnull】 【Least】【greatest】【is not null】【in 】【not in】【like】 【regexp】 【rlike】</p>
<p><img src="https://cdn.nlark.com/yuque/0/2021/png/2040418/1637212424074-023e20c5-8167-4ff5-a158-ee3244f28ae9.png" alt="img"></p>
<h4 id="LIKE运算符"><a href="#LIKE运算符" class="headerlink" title="LIKE运算符"></a>LIKE运算符</h4><p>LIKE运算符主要用来匹配字符串，通常用于模糊匹配，如果满足条件则返回1，否则返回0。如果给定的值或者匹配条件为NULL，则返回结果为NULL 。</p>
<p> “%”：匹配0个或多个字符。<br>“_”：只能匹配一个字符。 </p>
<h4 id="转移字符"><a href="#转移字符" class="headerlink" title="转移字符"></a>转移字符</h4><ul>
<li>回避特殊符号的：使用转义符<code>\\</code>。例如：将[%]转为[$%]、[]转为[$]，然后再加上[<code>ESCAPE$</code>]即可</li>
</ul>
<pre class="line-numbers language-sql"><code class="language-sql"><span class="token keyword">SELECT</span> job_id
<span class="token keyword">FROM</span> jobs
<span class="token keyword">WHERE</span> job_id <span class="token operator">LIKE</span> <span class="token string">'IT\_%'</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<ul>
<li>如果使用\表示转义，要省略ESCAPE。如果不是\，则要加上ESCAPE。</li>
</ul>
<pre class="line-numbers language-sql"><code class="language-sql"><span class="token keyword">SELECT</span> last_name
<span class="token keyword">FROM</span> employees
<span class="token keyword">WHERE</span> last_name <span class="token operator">LIKE</span> <span class="token string">'_o%'</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p><strong>REGEXP运算符</strong></p>
<ul>
<li><p><code>^</code>匹配以该字符后面的字符开头的字符串。</p>
</li>
<li><p><code>$</code>匹配以该字符前面的字符结尾的字符串。</p>
</li>
<li><p><code>.</code>匹配任何一个单字符。</p>
</li>
<li><p><code>[...]</code>匹配在方括号内的任何字符。</p>
</li>
<li><ul>
<li>在<code>[^...]</code>表示匹配除方块内的全部字符</li>
<li><code>[a - b]</code>表示匹配a到z的任意字符，数字同理</li>
</ul>
</li>
<li><p><code>*</code>匹配零个或多个在它前面的字符。例如，<code>x*</code>匹配任何数量的<code>x</code>字符，<code>[0-9]*</code>匹配任何数量的数字，而<code>*</code>匹配任何数量的任何字符。</p>
</li>
</ul>
<p><strong>exgexp和like的区别</strong></p>
<ul>
<li>like 匹配整个列</li>
<li>exgexp 匹配列中的某个字段</li>
</ul>
<hr>
<h3 id="3-逻辑运算符"><a href="#3-逻辑运算符" class="headerlink" title="3. 逻辑运算符"></a>3. 逻辑运算符</h3><p><img src="https://cdn.nlark.com/yuque/0/2021/png/2040418/1637216200912-0f7712e5-e408-4973-b3c7-31febcd507dd.png" alt="img"></p>
<p>只能对是否为0进行判别，而不能对null判别，出现null则为null</p>
<p>注意：</p>
<p>OR可以和AND一起使用，但是在使用时要注意两者的优先级，由于AND的优先级高于OR，因此先对AND两边的操作数进行操作，再与OR中的操作数结合 </p>
<h3 id="4-位运算符"><a href="#4-位运算符" class="headerlink" title="4. 位运算符"></a>4. 位运算符</h3><p><img src="https://cdn.nlark.com/yuque/0/2021/png/2040418/1637216401093-3812e97f-a74e-49bf-b972-c400dda4782e.png" alt="img"></p>
<h3 id="5-运算符的优先级"><a href="#5-运算符的优先级" class="headerlink" title="5. 运算符的优先级"></a>5. 运算符的优先级</h3><p><img src="https://cdn.nlark.com/yuque/0/2021/png/2040418/1637216483120-f9cc4d0c-25e5-42b5-af83-946446235556.png" alt="img"></p>
<p>数字编号越大，优先级越高，优先级高的运算符先进行计算。可以看到，赋值运算符的优先级最低，使用“()”括起来的表达式的优先级最高。 </p>
<h3 id="6-使用正则表达式查询"><a href="#6-使用正则表达式查询" class="headerlink" title="6 使用正则表达式查询   "></a>6 使用正则表达式查询   <img src="https://cdn.nlark.com/yuque/0/2021/png/2040418/1637216670545-41f96b1f-bd68-4958-a7ef-9790db48fe60.png" alt="img"></h3><h2 id="第05章：排序与分页"><a href="#第05章：排序与分页" class="headerlink" title="第05章：排序与分页"></a>第05章：排序与分页</h2><h3 id="1-排序数据"><a href="#1-排序数据" class="headerlink" title="1. 排序数据"></a>1. 排序数据</h3><p>使用 <code>ORDER BY</code> 子句排序 。</p>
<ul>
<li>ASC（ascend）: 升序</li>
<li>DESC（descend）:降序</li>
</ul>
<p>列的别名只能在order by 字句中使用 </p>
<h4 id="单列排序"><a href="#单列排序" class="headerlink" title="单列排序"></a>单列排序</h4><h4 id="多列排序"><a href="#多列排序" class="headerlink" title="多列排序"></a>多列排序</h4><h3 id="2-分页"><a href="#2-分页" class="headerlink" title="2. 分页"></a>2. 分页</h3><p>使用<code>LIMIT</code>实现分页</p>
<p>LIMIT [位置偏移量,] 行数 </p>
<p>MySQL 8.0中可以使用“LIMIT 3 OFFSET 4”，意思是获取从第5条记录开始后面的3条记录，和“LIMIT 4,3;”返回的结果相同 </p>
<p><strong>分页显式公式：</strong>（当前页数-1）*每页条数，每页条数 </p>
<pre class="line-numbers language-sql"><code class="language-sql"><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> <span class="token keyword">table</span>
<span class="token keyword">LIMIT</span><span class="token punctuation">(</span>PageNo <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span>PageSize<span class="token punctuation">,</span>PageSize<span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>注意：LIMIT 子句必须放在整个SELECT语句的最后 </p>
<h2 id="第06章：多表查询"><a href="#第06章：多表查询" class="headerlink" title="第06章：多表查询"></a>第06章：多表查询</h2><p>关联查询</p>
<p>n个表关联，至少需要n-1个连接条件</p>
<h3 id="1-等值连接VS非等值连接"><a href="#1-等值连接VS非等值连接" class="headerlink" title="1 等值连接VS非等值连接"></a>1 等值连接VS非等值连接</h3><p><strong>非等值连接</strong> </p>
<p><img src="https://cdn.nlark.com/yuque/0/2021/png/2040418/1637222544739-98022a28-da28-4ff9-859c-3100324b5301.png" alt="img"></p>
<h3 id="2-自连接VS非自连接"><a href="#2-自连接VS非自连接" class="headerlink" title="2 自连接VS非自连接"></a>2 自连接VS非自连接</h3><p><img src="https://cdn.nlark.com/yuque/0/2021/png/2040418/1637222876409-e7d2ac2e-5077-4b71-b8f1-20bae1c65957.png" alt="img"></p>
<h3 id="3-内连接VS非自连接"><a href="#3-内连接VS非自连接" class="headerlink" title="3 内连接VS非自连接"></a>3 内连接VS非自连接</h3><p><strong>外连接</strong>: 两个表在连接过程中除了返回满足连接条件的行以外还返回左（或右）表中不满足条件的行 ，这种连接称为左（或右） 外连接。没有匹配的行时, 结果表中相应的列为空(NULL)。 </p>
<ul>
<li>如果是左外连接，则连接条件中左边的表也称为 主表 ，右边的表称为 从表 。</li>
<li>如果是右外连接，则连接条件中右边的表也称为 主表 ，左边的表称为 从表 。</li>
</ul>
<p><strong>哪一方不满足连接查询条件的结果被查询出来就称为该方的外连接。</strong> </p>
<h4 id="SQL-99语法"><a href="#SQL-99语法" class="headerlink" title="SQL 99语法"></a>SQL 99语法</h4><p><img src="https://cdn.nlark.com/yuque/0/2021/png/2040418/1637223925418-6dc5a4e6-2bd9-4eb0-ac6f-f7fdd48d0ea8.png" alt="img"></p>
<p>使用JOIN…ON子句创建连接的语法结构 </p>
<pre class="line-numbers language-sql"><code class="language-sql"><span class="token keyword">SELECT</span> table1<span class="token punctuation">.</span><span class="token keyword">column</span><span class="token punctuation">,</span> table2<span class="token punctuation">.</span><span class="token keyword">column</span><span class="token punctuation">,</span>table3<span class="token punctuation">.</span><span class="token keyword">column</span>
<span class="token keyword">FROM</span> table1
    <span class="token keyword">JOIN</span> table2 <span class="token keyword">ON</span> table1 和 table2 的连接条件
        <span class="token keyword">JOIN</span> table3 <span class="token keyword">ON</span> table2 和 table3 的连接条件
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="内连接-INNER-JOIN-的实现"><a href="#内连接-INNER-JOIN-的实现" class="headerlink" title="内连接(INNER JOIN)的实现"></a>内连接(INNER JOIN)的实现</h4><pre class="line-numbers language-sql"><code class="language-sql"><span class="token keyword">SELECT</span> 字段列表
<span class="token keyword">FROM</span> A表 <span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> B表
<span class="token keyword">ON</span> 关联条件
<span class="token keyword">WHERE</span> 等其他子句<span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="外连接"><a href="#外连接" class="headerlink" title="外连接"></a>外连接</h4><ol>
<li><strong>左外连接</strong></li>
</ol>
<p><img src="https://cdn.nlark.com/yuque/0/2021/png/2040418/1637224724633-35172d2a-1f90-4013-a144-f1e3951b1131.png" alt="img"></p>
<ol>
<li><strong>右外连接</strong></li>
</ol>
<p><img src="https://cdn.nlark.com/yuque/0/2021/png/2040418/1637224715430-357c4120-8070-4db0-81aa-ce8c5eef2b15.png" alt="img"></p>
<ol>
<li><strong>满外连接</strong></li>
</ol>
<ul>
<li><p>满外连接的结果 &#x3D; 左右表匹配的数据 + 左表没有匹配到的数据 + 右表没有匹配到的数据。</p>
</li>
<li><p>SQL99是支持满外连接的。使用FULL JOIN 或 FULL OUTER JOIN来实现。</p>
</li>
<li><p>需要注意的是，MySQL不支持FULL JOIN，但是可以用 LEFT JOIN UNION RIGHT join代替</p>
</li>
</ul>
<hr>
<p><strong>7种SQL JOINS的实现</strong> </p>
<p><img src="https://cdn.nlark.com/yuque/0/2021/png/2040418/1637224885269-a1e4c644-7728-4646-a12b-04274b14662a.png" alt="img"></p>
<p>需要注意的是，LEFT JOIN 和 RIGHT JOIN 只存在于 SQL99 及以后的标准中，在 SQL92 中不存在，只能用 (+) 表示。  </p>
<p>使用<code>union all</code>时，若想进行排序，需要对查询的表起别名，以及在外嵌套一个select语句。</p>
<blockquote>
<p>需要注意使用<code>union</code>时<code>order by</code>语句只能使用一次，是对整个组合查询的排序</p>
</blockquote>
<pre class="line-numbers language-sql"><code class="language-sql"><span class="token comment" spellcheck="true">#6.列出所有人员和机构的对照关系</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span><span class="token punctuation">(</span><span class="token keyword">SELECT</span> <span class="token number">e</span><span class="token punctuation">.</span>id<span class="token punctuation">,</span>NAME<span class="token punctuation">,</span>age<span class="token punctuation">,</span>deptName <span class="token keyword">FROM</span> t_emp <span class="token number">e</span> <span class="token keyword">LEFT</span> <span class="token keyword">OUTER</span> <span class="token keyword">JOIN</span> t_dept <span class="token number">d</span> <span class="token keyword">ON</span> <span class="token number">e</span><span class="token punctuation">.</span><span class="token punctuation">`</span>deptId<span class="token punctuation">`</span><span class="token operator">=</span><span class="token number">d</span><span class="token punctuation">.</span><span class="token punctuation">`</span>id<span class="token punctuation">`</span> <span class="token punctuation">)</span> t1
<span class="token keyword">UNION</span> <span class="token keyword">ALL</span> 
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span><span class="token punctuation">(</span><span class="token keyword">SELECT</span> <span class="token number">e</span><span class="token punctuation">.</span>id<span class="token punctuation">,</span>NAME<span class="token punctuation">,</span>age<span class="token punctuation">,</span>deptName <span class="token keyword">FROM</span> t_emp <span class="token number">e</span> <span class="token keyword">RIGHT</span> <span class="token keyword">OUTER</span> <span class="token keyword">JOIN</span> t_dept <span class="token number">d</span> <span class="token keyword">ON</span> <span class="token number">e</span><span class="token punctuation">.</span><span class="token punctuation">`</span>deptId<span class="token punctuation">`</span><span class="token operator">=</span><span class="token number">d</span><span class="token punctuation">.</span><span class="token punctuation">`</span>id<span class="token punctuation">`</span><span class="token punctuation">)</span> t2
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> id
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="哪些情况需要用外连接，哪些情况需要使用内连接？"><a href="#哪些情况需要用外连接，哪些情况需要使用内连接？" class="headerlink" title="哪些情况需要用外连接，哪些情况需要使用内连接？"></a>哪些情况需要用外连接，哪些情况需要使用内连接？</h3><p>根据需要查询表的长短确定，是否需要使用外连接，当需要查询的数据长度有长度区分时使用外连接，否则使用内连接</p>
<h2 id="第07章：子查询"><a href="#第07章：子查询" class="headerlink" title="第07章：子查询"></a>第07章：子查询</h2><p>子查询指一个查询语句嵌套在另一个查询语句内部的查询  </p>
<p>注意事项</p>
<ul>
<li><p>子查询要包含在括号内</p>
</li>
<li><p>将子查询放在比较条件的右侧</p>
</li>
<li><p>单行操作符对应单行子查询，多行操作符对应多行子查询</p>
</li>
</ul>
<p><strong>子查询的分类</strong></p>
<ol>
<li><p>从内查询返回的结果的条目数</p>
</li>
<li><ol>
<li>单行子查询</li>
<li>多行子查询</li>
</ol>
</li>
<li><p>从内查询是否被执行多次</p>
</li>
<li><ol>
<li>相关子查询</li>
<li>不相关子查询</li>
</ol>
</li>
</ol>
<h3 id="单行子查询"><a href="#单行子查询" class="headerlink" title="单行子查询"></a>单行子查询</h3><h4 id="单行比较操作符"><a href="#单行比较操作符" class="headerlink" title="单行比较操作符"></a>单行比较操作符</h4><table>
<thead>
<tr>
<th>操作符</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td>&#x3D;</td>
<td>equal to</td>
</tr>
<tr>
<td>&gt;</td>
<td>greater than</td>
</tr>
<tr>
<td>&gt;&#x3D;</td>
<td>greater than or equal to</td>
</tr>
<tr>
<td>&lt;</td>
<td>less than</td>
</tr>
<tr>
<td>&lt;&#x3D;</td>
<td>less than or equal to</td>
</tr>
<tr>
<td>&lt;&gt;</td>
<td>not equal to</td>
</tr>
</tbody></table>
<h4 id="CASE中的子查询"><a href="#CASE中的子查询" class="headerlink" title="CASE中的子查询"></a>CASE中的子查询</h4><p>在条件中添加子查询</p>
<h4 id="子查询中的空值问题"><a href="#子查询中的空值问题" class="headerlink" title="子查询中的空值问题"></a>子查询中的空值问题</h4><p>当子查询没有结果时，就会出现空值问题</p>
<h4 id="非法使用子查询"><a href="#非法使用子查询" class="headerlink" title="非法使用子查询"></a>非法使用子查询</h4><p>当子查询返回的不是一个数据，而是多列数据，单行操作符无法匹配时，会出现非法情况</p>
<h3 id="多行子查询"><a href="#多行子查询" class="headerlink" title="多行子查询"></a>多行子查询</h3><h4 id="多行比较操作符"><a href="#多行比较操作符" class="headerlink" title="多行比较操作符"></a>多行比较操作符</h4><table>
<thead>
<tr>
<th>操作符</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td>IN</td>
<td>等于列表中的任意一个</td>
</tr>
<tr>
<td>ANY</td>
<td>需要和单行比较操作符一起使用，和子查询返回的某一个值比较</td>
</tr>
<tr>
<td>ALL</td>
<td>需要和单行比较操作符一起使用，和子查询返回的所有值比较</td>
</tr>
<tr>
<td>SOME</td>
<td>实际上是ANY的别名，作用相同，一般常使用ANY</td>
</tr>
</tbody></table>
<h4 id="代码演示"><a href="#代码演示" class="headerlink" title="代码演示"></a>代码演示</h4><p>使用到<code>from</code>中使用子查询，将子查询中的列当成一个新表查询</p>
<pre class="line-numbers language-sql"><code class="language-sql"><span class="token comment" spellcheck="true"># 查询平均工资最低的部门id</span>
<span class="token keyword">SELECT</span> department_id
<span class="token keyword">FROM</span> employees
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> department_id
<span class="token keyword">HAVING</span> <span class="token function">AVG</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span>
        <span class="token keyword">SELECT</span> <span class="token function">MIN</span><span class="token punctuation">(</span>avg_sal<span class="token punctuation">)</span>
        <span class="token keyword">FROM</span> <span class="token punctuation">(</span>
            <span class="token keyword">SELECT</span> <span class="token function">AVG</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> avg_sal
            <span class="token keyword">FROM</span> employees
            <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> department_id
            <span class="token punctuation">)</span> t_dept_avg_sal
            <span class="token punctuation">)</span>

<span class="token keyword">SELECT</span> department_id
<span class="token keyword">FROM</span> employees
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> department_id
<span class="token keyword">HAVING</span> <span class="token function">AVG</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token keyword">ALL</span><span class="token punctuation">(</span>
            <span class="token keyword">SELECT</span> <span class="token function">AVG</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> avg_sal
            <span class="token keyword">FROM</span> employees
            <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> department_id
            <span class="token punctuation">)</span>
  
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>使用不同策略取得最小值</strong></p>
<ul>
<li><p>方式一 从表中取得最小</p>
</li>
<li><p>方式二 比任意一个数都小得到最小值</p>
</li>
<li><p>方式三：通过分页取得最小</p>
</li>
<li><p>方式四：从两张表中拼接</p>
</li>
</ul>
<pre class="line-numbers language-sql"><code class="language-sql"><span class="token comment" spellcheck="true">#8.查询平均工资最低的部门信息</span>
<span class="token comment" spellcheck="true"># 方式一 从表中取得最小</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> departments
<span class="token keyword">WHERE</span> department_id <span class="token operator">=</span> 
    <span class="token punctuation">(</span><span class="token keyword">SELECT</span> department_id <span class="token keyword">FROM</span> employees <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> department_id
    <span class="token keyword">HAVING</span> <span class="token function">AVG</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> <span class="token operator">=</span> 
        <span class="token punctuation">(</span><span class="token keyword">SELECT</span> <span class="token function">MIN</span><span class="token punctuation">(</span>avg_sal<span class="token punctuation">)</span> <span class="token keyword">FROM</span> 
            <span class="token punctuation">(</span><span class="token keyword">SELECT</span> <span class="token function">AVG</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> avg_sal <span class="token keyword">FROM</span> employees <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> department_id<span class="token punctuation">)</span> t_dept_avg_sal
        <span class="token punctuation">)</span>
    <span class="token punctuation">)</span>

<span class="token comment" spellcheck="true"># 方式二 比任意一个数都小得到最小值</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span>
<span class="token keyword">FROM</span> departments
<span class="token keyword">WHERE</span> department_id <span class="token operator">=</span> <span class="token punctuation">(</span>
    <span class="token keyword">SELECT</span> department_id
    <span class="token keyword">FROM</span> employees
    <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> department_id
    <span class="token keyword">HAVING</span> <span class="token function">AVG</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token keyword">ALL</span><span class="token punctuation">(</span>
    <span class="token keyword">SELECT</span> <span class="token function">AVG</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> avg_sal
    <span class="token keyword">FROM</span> employees
    <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> department_id
    <span class="token punctuation">)</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">#方式三：</span>
<span class="token comment" spellcheck="true"># 通过分页取得最小</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span>
<span class="token keyword">FROM</span> departments
<span class="token keyword">WHERE</span> department_id <span class="token operator">=</span> <span class="token punctuation">(</span>
        <span class="token keyword">SELECT</span> department_id
        <span class="token keyword">FROM</span> employees
        <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> department_id
        <span class="token keyword">HAVING</span> <span class="token function">AVG</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span>
                    <span class="token keyword">SELECT</span> <span class="token function">AVG</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> avg_sal
                    <span class="token keyword">FROM</span> employees
                    <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> department_id
                    <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> avg_sal
                    <span class="token keyword">LIMIT</span> <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span>
                    <span class="token punctuation">)</span>
        <span class="token punctuation">)</span>
<span class="token comment" spellcheck="true">#方式四：</span>
<span class="token comment" spellcheck="true"># 从两张表中拼接</span>
<span class="token keyword">SELECT</span> <span class="token number">d</span><span class="token punctuation">.</span><span class="token operator">*</span>
<span class="token keyword">FROM</span> departments <span class="token number">d</span><span class="token punctuation">,</span><span class="token punctuation">(</span>
        <span class="token keyword">SELECT</span> department_id<span class="token punctuation">,</span><span class="token function">AVG</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> avg_sal
        <span class="token keyword">FROM</span> employees
        <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> department_id
        <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> avg_sal
        <span class="token keyword">LIMIT</span> <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> dept_avg_sal
<span class="token keyword">WHERE</span> <span class="token number">d</span><span class="token punctuation">.</span>department_id <span class="token operator">=</span> dept_avg_sal<span class="token punctuation">.</span>department_id



<span class="token keyword">SELECT</span> <span class="token number">d</span><span class="token punctuation">.</span><span class="token operator">*</span> <span class="token keyword">FROM</span> departments <span class="token number">d</span><span class="token punctuation">,</span>
    <span class="token punctuation">(</span><span class="token keyword">SELECT</span> department_id<span class="token punctuation">,</span><span class="token function">AVG</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> avg_sal
    <span class="token keyword">FROM</span> employees <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> department_id
    <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> avg_sal
    <span class="token keyword">LIMIT</span> <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span>
    <span class="token punctuation">)</span> t_dept_avg_sal
<span class="token keyword">WHERE</span> <span class="token number">d</span><span class="token punctuation">.</span>department_id <span class="token operator">=</span> t_dept_avg_sal<span class="token punctuation">.</span>department_id
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="空值问题"><a href="#空值问题" class="headerlink" title="空值问题"></a>空值问题</h4><p>当使用子查询时没有数据时，需要检查是否是空值问题</p>
<h3 id="相关子查询"><a href="#相关子查询" class="headerlink" title="相关子查询"></a>相关子查询</h3><p>当子查询查询的条件需要使用外查询的条件时，称为相关子查询</p>
<pre class="line-numbers language-sql"><code class="language-sql"><span class="token comment" spellcheck="true">#查询员工中工资大于 本部门平均工资 的员工的last_name,salary和其department_id</span>
<span class="token keyword">SELECT</span> last_name<span class="token punctuation">,</span>salary<span class="token punctuation">,</span>department_id
<span class="token keyword">FROM</span> employees <span class="token number">e</span>
<span class="token keyword">WHERE</span> salary <span class="token operator">></span> <span class="token punctuation">(</span>
        <span class="token keyword">SELECT</span> <span class="token function">AVG</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span>
        <span class="token keyword">FROM</span> employees
        <span class="token keyword">WHERE</span> department_id <span class="token operator">=</span> <span class="token number">e</span><span class="token punctuation">.</span>department_id
<span class="token punctuation">)</span>

<span class="token keyword">SELECT</span> <span class="token number">e</span><span class="token punctuation">.</span>last_name<span class="token punctuation">,</span><span class="token number">e</span><span class="token punctuation">.</span>salary<span class="token punctuation">,</span><span class="token number">e</span><span class="token punctuation">.</span>department_id<span class="token punctuation">,</span>avg_sal
<span class="token keyword">FROM</span> employees <span class="token number">e</span><span class="token punctuation">,</span><span class="token punctuation">(</span>
        <span class="token keyword">SELECT</span> department_id<span class="token punctuation">,</span><span class="token function">AVG</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> avg_sal
        <span class="token keyword">FROM</span> employees
        <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> department_id
        <span class="token punctuation">)</span> t_dept_avg_sal
<span class="token keyword">WHERE</span> <span class="token number">e</span><span class="token punctuation">.</span>department_id <span class="token operator">=</span> t_dept_avg_sal<span class="token punctuation">.</span>department_id
<span class="token operator">AND</span> <span class="token number">e</span><span class="token punctuation">.</span>salary <span class="token operator">></span> avg_sal

<span class="token keyword">SELECT</span> <span class="token function">AVG</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> <span class="token keyword">FROM</span> employees



<span class="token comment" spellcheck="true"># 题目：查询员工的id,salary,按照department_name 排序</span>
<span class="token keyword">SELECT</span> employee_id <span class="token punctuation">,</span> salary
<span class="token keyword">FROM</span> employees <span class="token number">e</span>
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> <span class="token punctuation">(</span>
    <span class="token keyword">SELECT</span> department_name
    <span class="token keyword">FROM</span> departments <span class="token number">d</span>
    <span class="token keyword">WHERE</span> <span class="token number">e</span><span class="token punctuation">.</span>department_id <span class="token operator">=</span> <span class="token number">d</span><span class="token punctuation">.</span><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span>
<span class="token punctuation">)</span> <span class="token keyword">DESC</span><span class="token punctuation">;</span>


<span class="token comment" spellcheck="true"># 题目：若employees表中employee_id与job_history表中employee_id相同的数目不小于2，</span>
<span class="token comment" spellcheck="true">#输出这些相同id的员工的employee_id,last_name和其job_id</span>
<span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span>last_name<span class="token punctuation">,</span>job_id
<span class="token keyword">FROM</span> employees <span class="token number">e</span> 
<span class="token keyword">WHERE</span> <span class="token number">2</span> <span class="token operator">&lt;=</span> <span class="token punctuation">(</span>
    <span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>
    <span class="token keyword">FROM</span> job_history j
    <span class="token keyword">WHERE</span> <span class="token number">e</span><span class="token punctuation">.</span><span class="token punctuation">`</span>employee_id<span class="token punctuation">`</span><span class="token operator">=</span>j<span class="token punctuation">.</span><span class="token punctuation">`</span>employee_id<span class="token punctuation">`</span>

<span class="token punctuation">)</span>
        
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="EXISTS-与-NOT-EXISTS关键字"><a href="#EXISTS-与-NOT-EXISTS关键字" class="headerlink" title="EXISTS 与 NOT EXISTS关键字"></a>EXISTS 与 NOT EXISTS关键字</h4><p><strong>使用</strong><code>**exists**</code><strong>和</strong><code>**not exists**</code><strong>和外连接查询的区别</strong></p>
<ul>
<li>外连接查询是针对两个表中取得结果</li>
<li>而<code>exists</code>和<code>not exists</code>是根据某表中的结果进行分类。如果<code>exists</code>则归为一类，<code>not exists</code>归为另一类。</li>
</ul>
<pre class="line-numbers language-sql"><code class="language-sql"><span class="token comment" spellcheck="true"># 查询公司管理者的employee_id，last_name，job_id，department_id信息</span>
<span class="token keyword">SELECT</span> <span class="token keyword">DISTINCT</span> <span class="token number">e</span><span class="token punctuation">.</span>employee_id<span class="token punctuation">,</span><span class="token number">e</span><span class="token punctuation">.</span>last_name<span class="token punctuation">,</span><span class="token number">e</span><span class="token punctuation">.</span>job_id<span class="token punctuation">,</span><span class="token number">e</span><span class="token punctuation">.</span>department_id
<span class="token keyword">FROM</span> employees <span class="token number">e</span> <span class="token keyword">JOIN</span> employees m
<span class="token keyword">ON</span> <span class="token number">e</span><span class="token punctuation">.</span><span class="token punctuation">`</span>employee_id<span class="token punctuation">`</span> <span class="token operator">=</span> m<span class="token punctuation">.</span>manager_id

<span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span>last_name<span class="token punctuation">,</span>job_id<span class="token punctuation">,</span>department_id
<span class="token keyword">FROM</span> employees <span class="token number">e</span>
<span class="token keyword">WHERE</span> <span class="token number">e</span><span class="token punctuation">.</span><span class="token punctuation">`</span>employee_id<span class="token punctuation">`</span> <span class="token operator">IN</span> <span class="token punctuation">(</span>
        <span class="token keyword">SELECT</span> <span class="token keyword">DISTINCT</span> manager_id
        <span class="token keyword">FROM</span> employees
        <span class="token punctuation">)</span>
        
<span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span> last_name<span class="token punctuation">,</span> job_id<span class="token punctuation">,</span> department_id
<span class="token keyword">FROM</span> employees <span class="token number">e1</span>
<span class="token keyword">WHERE</span> <span class="token keyword">EXISTS</span> <span class="token punctuation">(</span> <span class="token keyword">SELECT</span> <span class="token operator">*</span>
        <span class="token keyword">FROM</span> employees <span class="token number">e2</span>
        <span class="token keyword">WHERE</span> <span class="token number">e2</span><span class="token punctuation">.</span>manager_id <span class="token operator">=</span>
        <span class="token number">e1</span><span class="token punctuation">.</span>employee_id<span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        
        
<span class="token comment" spellcheck="true">## 题目：查询departments表中，不存在于employees表中的部门的department_id和department_name</span>

<span class="token keyword">SELECT</span> <span class="token number">d</span><span class="token punctuation">.</span>department_id<span class="token punctuation">,</span><span class="token number">d</span><span class="token punctuation">.</span>department_name
<span class="token keyword">FROM</span> departments <span class="token number">d</span> <span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> employees <span class="token number">e</span>
<span class="token keyword">ON</span> <span class="token number">d</span><span class="token punctuation">.</span><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span> <span class="token operator">=</span> <span class="token number">e</span><span class="token punctuation">.</span><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span>
<span class="token keyword">WHERE</span> <span class="token number">e</span><span class="token punctuation">.</span><span class="token punctuation">`</span>employee_id<span class="token punctuation">`</span> <span class="token operator">IS</span> <span class="token boolean">NULL</span>


<span class="token keyword">SELECT</span> <span class="token number">d</span><span class="token punctuation">.</span>department_id<span class="token punctuation">,</span><span class="token number">d</span><span class="token punctuation">.</span>department_name
<span class="token keyword">FROM</span> departments <span class="token number">d</span> 
<span class="token keyword">WHERE</span> <span class="token operator">NOT</span> <span class="token keyword">EXISTS</span> <span class="token punctuation">(</span>
        <span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> employees <span class="token number">e</span>
        <span class="token keyword">WHERE</span> <span class="token number">d</span><span class="token punctuation">.</span><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span> <span class="token operator">=</span> <span class="token number">e</span><span class="token punctuation">.</span><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span>
        <span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>需要注意，相关子查询的连接条件</strong></p>
<pre class="line-numbers language-sql"><code class="language-sql"><span class="token comment" spellcheck="true">#15. 查询部门的部门号，其中不包括job_id是"ST_CLERK"的部门号</span>

<span class="token comment" spellcheck="true">#方法一：</span>
<span class="token keyword">SELECT</span> department_id
<span class="token keyword">FROM</span> departments <span class="token number">d</span>
<span class="token keyword">WHERE</span> department_id <span class="token operator">NOT</span> <span class="token operator">IN</span> <span class="token punctuation">(</span>
<span class="token keyword">SELECT</span> <span class="token keyword">DISTINCT</span> department_id
<span class="token keyword">FROM</span> employees
<span class="token keyword">WHERE</span> job_id <span class="token operator">=</span> <span class="token string">'ST_CLERK'</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">SELECT</span> department_id
<span class="token keyword">FROM</span> departments <span class="token number">d1</span> 
<span class="token keyword">WHERE</span> <span class="token operator">NOT</span> <span class="token keyword">EXISTS</span> <span class="token punctuation">(</span> <span class="token keyword">SELECT</span> <span class="token operator">*</span> 
        <span class="token keyword">FROM</span> employees <span class="token number">e2</span> 
        <span class="token keyword">WHERE</span> <span class="token number">d1</span><span class="token punctuation">.</span>department_id <span class="token operator">=</span> <span class="token number">e2</span><span class="token punctuation">.</span>department_id
        <span class="token operator">AND</span> <span class="token number">e2</span><span class="token punctuation">.</span><span class="token punctuation">`</span>job_id<span class="token punctuation">`</span> <span class="token operator">=</span> <span class="token string">'ST_CLERK'</span><span class="token punctuation">)</span>


<span class="token keyword">SELECT</span> department_id 
<span class="token keyword">FROM</span> departments <span class="token number">d</span>
<span class="token keyword">WHERE</span> department_id <span class="token operator">NOT</span> <span class="token operator">IN</span><span class="token punctuation">(</span>
    <span class="token keyword">SELECT</span> <span class="token keyword">DISTINCT</span> department_id <span class="token keyword">FROM</span> employees <span class="token number">e2</span>
    <span class="token keyword">WHERE</span> <span class="token number">e2</span><span class="token punctuation">.</span>job_id <span class="token operator">=</span> <span class="token string">'ST_CLERK'</span>
<span class="token punctuation">)</span>


<span class="token comment" spellcheck="true">#16. 选择所有没有管理者的员工的last_name</span>
<span class="token keyword">SELECT</span> last_name
<span class="token keyword">FROM</span> employees
<span class="token keyword">WHERE</span> manager_id <span class="token operator">IS</span> <span class="token boolean">NULL</span>

<span class="token keyword">SELECT</span> last_name
<span class="token keyword">FROM</span> employees <span class="token number">e1</span>
<span class="token keyword">WHERE</span> <span class="token operator">NOT</span> <span class="token keyword">EXISTS</span> <span class="token punctuation">(</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span>
<span class="token keyword">FROM</span> employees <span class="token number">e2</span>
<span class="token keyword">WHERE</span> <span class="token number">e1</span><span class="token punctuation">.</span>manager_id <span class="token operator">=</span> <span class="token number">e2</span><span class="token punctuation">.</span>employee_id
<span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token comment" spellcheck="true">#17．查询员工号、姓名、雇用时间、工资，其中员工的管理者为 'De Haan'</span>
<span class="token keyword">SELECT</span> <span class="token number">e1</span><span class="token punctuation">.</span>employee_id <span class="token punctuation">,</span> <span class="token number">e1</span><span class="token punctuation">.</span>last_name <span class="token punctuation">,</span> <span class="token number">e1</span><span class="token punctuation">.</span>hire_date <span class="token punctuation">,</span> <span class="token number">e1</span><span class="token punctuation">.</span>salary
<span class="token keyword">FROM</span> employees <span class="token number">e1</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token keyword">SELECT</span> employee_id <span class="token keyword">FROM</span> employees <span class="token number">e2</span>
        <span class="token keyword">WHERE</span> <span class="token number">e2</span><span class="token punctuation">.</span><span class="token punctuation">`</span>last_name<span class="token punctuation">`</span><span class="token operator">=</span><span class="token string">'De Haan'</span>
            <span class="token punctuation">)</span> <span class="token number">ee</span>
<span class="token keyword">WHERE</span> <span class="token number">e1</span><span class="token punctuation">.</span>manager_id <span class="token operator">=</span> <span class="token number">ee</span><span class="token punctuation">.</span>employee_id

<span class="token comment" spellcheck="true">#方式1：</span>
<span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span> last_name<span class="token punctuation">,</span> hire_date<span class="token punctuation">,</span> salary
<span class="token keyword">FROM</span> employees
<span class="token keyword">WHERE</span> manager_id <span class="token operator">=</span> <span class="token punctuation">(</span>
<span class="token keyword">SELECT</span> employee_id
<span class="token keyword">FROM</span> employees
<span class="token keyword">WHERE</span> last_name <span class="token operator">=</span> <span class="token string">'De Haan'</span>
<span class="token punctuation">)</span>

<span class="token keyword">SELECT</span> <span class="token number">e1</span><span class="token punctuation">.</span>employee_id <span class="token punctuation">,</span> <span class="token number">e1</span><span class="token punctuation">.</span>last_name <span class="token punctuation">,</span> <span class="token number">e1</span><span class="token punctuation">.</span>hire_date <span class="token punctuation">,</span> <span class="token number">e1</span><span class="token punctuation">.</span>salary
<span class="token keyword">FROM</span> employees <span class="token number">e1</span>
<span class="token keyword">WHERE</span> <span class="token keyword">EXISTS</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> employees <span class="token number">e2</span>
        <span class="token keyword">WHERE</span> <span class="token number">e2</span><span class="token punctuation">.</span><span class="token punctuation">`</span>last_name<span class="token punctuation">`</span><span class="token operator">=</span><span class="token string">'De Haan'</span>
        <span class="token operator">AND</span> <span class="token number">e1</span><span class="token punctuation">.</span>manager_id <span class="token operator">=</span> <span class="token number">e2</span><span class="token punctuation">.</span>employee_id
    <span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="相关更新"><a href="#相关更新" class="headerlink" title="相关更新"></a>相关更新</h4><p><img src="https://cdn.nlark.com/yuque/0/2021/png/2040418/1637333822498-63721f3b-248e-4c41-93b7-11821d189a30.png" alt="img"></p>
<h4 id="相关删除"><a href="#相关删除" class="headerlink" title="相关删除"></a>相关删除</h4><p><img src="https://cdn.nlark.com/yuque/0/2021/png/2040418/1637333835545-b9dcecf6-886b-44cb-93be-79d31f7039fc.png" alt="img"></p>
<h3 id="结论"><a href="#结论" class="headerlink" title="结论"></a>结论</h3><p>子查询适用的条件，除了<code>group by</code>和&#96;&#96;&#96;limit&#96;中不可使用子查询。其他情况都能使用子查询</p>
<pre class="line-numbers language-sql"><code class="language-sql"><span class="token keyword">SELECT</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">(</span>存在聚合函数<span class="token punctuation">)</span>
<span class="token keyword">FROM</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">(</span><span class="token keyword">LEFT</span> <span class="token operator">/</span> <span class="token keyword">RIGHT</span><span class="token punctuation">)</span><span class="token keyword">JOIN</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token keyword">ON</span> 多表的连接条件 
<span class="token punctuation">(</span><span class="token keyword">LEFT</span> <span class="token operator">/</span> <span class="token keyword">RIGHT</span><span class="token punctuation">)</span><span class="token keyword">JOIN</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token keyword">ON</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token keyword">WHERE</span> 不包含聚合函数的过滤条件
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token keyword">HAVING</span> 包含聚合函数的过滤条件
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">(</span><span class="token keyword">ASC</span> <span class="token operator">/</span> <span class="token keyword">DESC</span> <span class="token punctuation">)</span>
<span class="token keyword">LIMIT</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h3><p><a target="_blank" rel="noopener" href="https://www.yuque.com/attachments/yuque/0/2021/pdf/2040418/1637333868521-19599f42-2d56-4946-bd6b-3bc4788910a6.pdf">📎第09章_子查询.pdf</a></p>
<h1 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h1><h2 id="第08章：单行函数"><a href="#第08章：单行函数" class="headerlink" title="第08章：单行函数"></a>第08章：单行函数</h2><ul>
<li><p>操作数据对象</p>
</li>
<li><p>接受参数返回一个结果</p>
</li>
<li><p>只对一行进行变换</p>
</li>
<li><p>每行返回一个结果</p>
</li>
<li><p>可以嵌套</p>
</li>
<li><p>参数可以是一列或一个值</p>
</li>
</ul>
<h3 id="数值函数"><a href="#数值函数" class="headerlink" title="数值函数"></a>数值函数</h3><h4 id="基本函数【重点】"><a href="#基本函数【重点】" class="headerlink" title="基本函数【重点】"></a>基本函数【重点】</h4><table>
<thead>
<tr>
<th>函数</th>
<th>用法</th>
</tr>
</thead>
<tbody><tr>
<td>ABS(x)</td>
<td>返回x的绝对值</td>
</tr>
<tr>
<td>SIGN(X)</td>
<td>返回X的符号。正数返回1，负数返回-1，0返回0</td>
</tr>
<tr>
<td>PI()</td>
<td>返回圆周率的值</td>
</tr>
<tr>
<td>CEIL(x)，CEILING(x)</td>
<td>返回大于或等于某个值的最小整数</td>
</tr>
<tr>
<td>FLOOR(x)</td>
<td>返回小于或等于某个值的最大整数</td>
</tr>
<tr>
<td>LEAST(e1,e2,e3…)</td>
<td>返回列表中的最小值</td>
</tr>
<tr>
<td>GREATEST(e1,e2,e3…)</td>
<td>返回列表中的最大值</td>
</tr>
<tr>
<td>MOD(x,y)</td>
<td>返回X除以Y后的余数</td>
</tr>
<tr>
<td>RAND()</td>
<td>返回0~1的随机值</td>
</tr>
<tr>
<td>RAND(x)</td>
<td>返回0~1的随机值，其中x的值用作种子值，相同的X值会产生相同的随机 数</td>
</tr>
<tr>
<td>ROUND(x)</td>
<td>返回一个对x的值进行四舍五入后，最接近于X的整数</td>
</tr>
<tr>
<td>ROUND(x,y)</td>
<td>返回一个对x的值进行四舍五入后最接近X的值，并保留到小数点后面Y位</td>
</tr>
<tr>
<td>TRUNCATE(x,y)</td>
<td>返回数字x截断为y位小数的结果</td>
</tr>
<tr>
<td>SQRT(x)</td>
<td>返回x的平方根。当X的值为负数时，返回NULL</td>
</tr>
</tbody></table>
<h4 id="角度与弧度互换函数"><a href="#角度与弧度互换函数" class="headerlink" title="角度与弧度互换函数"></a>角度与弧度互换函数</h4><table>
<thead>
<tr>
<th>函数</th>
<th>用法</th>
</tr>
</thead>
<tbody><tr>
<td>RADIANS(x)</td>
<td>将角度转化为弧度，其中，参数x为角度值</td>
</tr>
<tr>
<td>DEGREES(x)</td>
<td>将弧度转化为角度，其中，参数x为弧度值</td>
</tr>
</tbody></table>
<h4 id="三角函数"><a href="#三角函数" class="headerlink" title="三角函数"></a>三角函数</h4><table>
<thead>
<tr>
<th>函数</th>
<th>用法</th>
</tr>
</thead>
<tbody><tr>
<td>SIN(x)</td>
<td>返回x的正弦值，其中，参数x为弧度值</td>
</tr>
<tr>
<td>ASIN(x)</td>
<td>返回x的反正弦值，即获取正弦为x的值。如果x的值不在-1到1之间，则返回NULL</td>
</tr>
<tr>
<td>COS(x)</td>
<td>返回x的余弦值，其中，参数x为弧度值</td>
</tr>
<tr>
<td>ACOS(x)</td>
<td>返回x的反余弦值，即获取余弦为x的值。如果x的值不在-1到1之间，则返回NULL</td>
</tr>
<tr>
<td>TAN(x)</td>
<td>返回x的正切值，其中，参数x为弧度值</td>
</tr>
<tr>
<td>ATAN(x)</td>
<td>返回x的反正切值，即返回正切值为x的值</td>
</tr>
<tr>
<td>ATAN2(m,n)</td>
<td>返回两个参数的反正切值</td>
</tr>
<tr>
<td>COT(x)</td>
<td>返回x的余切值，其中，X为弧度值</td>
</tr>
</tbody></table>
<h4 id="指数与对数"><a href="#指数与对数" class="headerlink" title="指数与对数"></a>指数与对数</h4><table>
<thead>
<tr>
<th>函数</th>
<th>用法</th>
</tr>
</thead>
<tbody><tr>
<td>POW(x,y)，POWER(X,Y)</td>
<td>返回x的y次方</td>
</tr>
<tr>
<td>EXP(X)</td>
<td>返回e的X次方，其中e是一个常数，2.718281828459045</td>
</tr>
<tr>
<td>LN(X)，LOG(X)</td>
<td>返回以e为底的X的对数，当X &lt;&#x3D; 0 时，返回的结果为NULL</td>
</tr>
<tr>
<td>LOG10(X)</td>
<td>返回以10为底的X的对数，当X &lt;&#x3D; 0 时，返回的结果为NULL</td>
</tr>
<tr>
<td>LOG2(X)</td>
<td>返回以2为底的X的对数，当X &lt;&#x3D; 0 时，返回NULL</td>
</tr>
</tbody></table>
<h4 id="进制间的转换"><a href="#进制间的转换" class="headerlink" title="进制间的转换"></a>进制间的转换</h4><table>
<thead>
<tr>
<th>函数</th>
<th>用法</th>
</tr>
</thead>
<tbody><tr>
<td>BIN(x)</td>
<td>返回x的二进制编码</td>
</tr>
<tr>
<td>HEX(x)</td>
<td>返回x的十六进制编码</td>
</tr>
<tr>
<td>OCT(x)</td>
<td>返回x的八进制编码</td>
</tr>
<tr>
<td>CONV(x,f1,f2)</td>
<td>返回f1进制数变成f2进制数</td>
</tr>
</tbody></table>
<h3 id="字符串函数【重点】"><a href="#字符串函数【重点】" class="headerlink" title="字符串函数【重点】"></a>字符串函数【重点】</h3><table>
<thead>
<tr>
<th>函数</th>
<th>用法</th>
</tr>
</thead>
<tbody><tr>
<td>ASCII(S)</td>
<td>返回字符串S中的第一个字符的ASCII码值</td>
</tr>
<tr>
<td>CHAR_LENGTH(s)</td>
<td>返回字符串s的字符数。作用与CHARACTER_LENGTH(s)相同</td>
</tr>
<tr>
<td>LENGTH(s)</td>
<td>返回字符串s的字节数，和字符集有关</td>
</tr>
<tr>
<td>CONCAT(s1,s2,……,sn)</td>
<td>连接s1,s2,……,sn为一个字符串</td>
</tr>
<tr>
<td>CONCAT_WS(x, s1,s2,……,sn)</td>
<td>同CONCAT(s1,s2,…)函数，但是每个字符串之间要加上x</td>
</tr>
<tr>
<td>INSERT(str, idx, len, replacestr)</td>
<td>将字符串str从第idx位置开始，len个字符长的子串替换为字符串replacestr</td>
</tr>
<tr>
<td>REPLACE(str, a, b)</td>
<td>用字符串b替换字符串str中所有出现的字符串a</td>
</tr>
<tr>
<td>UPPER(s) 或 UCASE(s)</td>
<td>将字符串s的所有字母转成大写字母</td>
</tr>
<tr>
<td>LOWER(s) 或LCASE(s)</td>
<td>将字符串s的所有字母转成小写字母</td>
</tr>
<tr>
<td>LEFT(str,n)</td>
<td>返回字符串str最左边的n个字符</td>
</tr>
<tr>
<td>RIGHT(str,n)</td>
<td>返回字符串str最右边的n个字符</td>
</tr>
<tr>
<td>LPAD(str, len, pad)</td>
<td>用字符串pad对str最左边进行填充，直到str的长度为len个字符</td>
</tr>
<tr>
<td>RPAD(str ,len, pad)</td>
<td>用字符串pad对str最右边进行填充，直到str的长度为len个字符</td>
</tr>
<tr>
<td>LTRIM(s)</td>
<td>去掉字符串s左侧的空格</td>
</tr>
<tr>
<td>RTRIM(s)</td>
<td>去掉字符串s右侧的空格</td>
</tr>
<tr>
<td>TRIM(s)</td>
<td>去掉字符串s开始与结尾的空格</td>
</tr>
<tr>
<td>TRIM(s1 FROM s)</td>
<td>去掉字符串s开始与结尾的s1</td>
</tr>
<tr>
<td>TRIM(LEADING s1 FROM s)</td>
<td>去掉字符串s开始处的s1</td>
</tr>
<tr>
<td>TRIM(TRAILING s1 FROM s)</td>
<td>去掉字符串s结尾处的s1</td>
</tr>
<tr>
<td>REPEAT(str, n)</td>
<td>返回str重复n次的结果</td>
</tr>
<tr>
<td>SPACE(n)</td>
<td>返回n个空格</td>
</tr>
<tr>
<td>STRCMP(s1,s2)</td>
<td>比较字符串s1,s2的ASCII码值的大小</td>
</tr>
<tr>
<td>SUBSTR(s,index,len)</td>
<td>返回从字符串s的index位置其len个字符，作用与SUBSTRING(s,n,len)、 MID(s,n,len)相同</td>
</tr>
<tr>
<td>LOCATE(substr,str)</td>
<td>返回字符串substr在字符串str中首次出现的位置，作用于POSITION(substr IN str)、INSTR(str,substr)相同。未找到，返回0</td>
</tr>
<tr>
<td>ELT(m,s1,s2,…,sn)</td>
<td>返回指定位置的字符串，如果m&#x3D;1，则返回s1，如果m&#x3D;2，则返回s2，如 果m&#x3D;n，则返回sn</td>
</tr>
<tr>
<td>FIELD(s,s1,s2,…,sn)</td>
<td>返回字符串s在字符串列表中第一次出现的位置</td>
</tr>
<tr>
<td>FIND_IN_SET(s1,s2)</td>
<td>返回字符串s1在字符串s2中出现的位置。其中，字符串s2是一个以逗号分 隔的字符串</td>
</tr>
<tr>
<td>REVERSE(s)</td>
<td>返回s反转后的字符串</td>
</tr>
<tr>
<td>NULLIF(value1,value2)</td>
<td>比较两个字符串，如果value1与value2相等，则返回NULL，否则返回 value1</td>
</tr>
</tbody></table>
<p>注意：MySQL中，字符串的位置是从1开始的 </p>
<h3 id="日期和时间函数"><a href="#日期和时间函数" class="headerlink" title="日期和时间函数"></a>日期和时间函数</h3><h4 id="获取日期、时间"><a href="#获取日期、时间" class="headerlink" title="获取日期、时间"></a>获取日期、时间</h4><table>
<thead>
<tr>
<th>函数</th>
<th>用法</th>
</tr>
</thead>
<tbody><tr>
<td>CURDATE() ，CURRENT_DATE()</td>
<td>返回当前日期，只包含年、 月、日</td>
</tr>
<tr>
<td>CURTIME() ， CURRENT_TIME()</td>
<td>返回当前时间，只包含时、 分、秒</td>
</tr>
<tr>
<td>NOW() &#x2F; SYSDATE() &#x2F; CURRENT_TIMESTAMP() &#x2F; LOCALTIME() &#x2F; LOCALTIMESTAMP()</td>
<td>返回当前系统日期和时间</td>
</tr>
<tr>
<td>UTC_DATE()</td>
<td>返回UTC（世界标准时间） 日期</td>
</tr>
<tr>
<td>UTC_TIME()</td>
<td>返回UTC（世界标准时间） 时间</td>
</tr>
</tbody></table>
<h4 id="日期与时间戳的转换"><a href="#日期与时间戳的转换" class="headerlink" title="日期与时间戳的转换"></a>日期与时间戳的转换</h4><table>
<thead>
<tr>
<th>函数</th>
<th>用法</th>
</tr>
</thead>
<tbody><tr>
<td>UNIX_TIMESTAMP()</td>
<td>以UNIX时间戳的形式返回当前时间。SELECT UNIX_TIMESTAMP() - &gt;1634348884</td>
</tr>
<tr>
<td>UNIX_TIMESTAMP(date)</td>
<td>将时间date以UNIX时间戳的形式返回。</td>
</tr>
<tr>
<td>FROM_UNIXTIME(timestamp)</td>
<td>将UNIX时间戳的时间转换为普通格式的时间</td>
</tr>
</tbody></table>
<h4 id="计算日期和时间的函数"><a href="#计算日期和时间的函数" class="headerlink" title="计算日期和时间的函数"></a>计算日期和时间的函数</h4><table>
<thead>
<tr>
<th>函数</th>
<th>用法</th>
</tr>
</thead>
<tbody><tr>
<td>DATE_ADD(datetime, INTERVAL expr type)， ADDDATE(date,INTERVAL expr type)</td>
<td>返回与给定日期时间相差INTERVAL时 间段的日期时间</td>
</tr>
<tr>
<td>DATE_SUB(date,INTERVAL expr type)， SUBDATE(date,INTERVAL expr type)</td>
<td>返回与date相差INTERVAL时间间隔的 日期</td>
</tr>
</tbody></table>
<p> <img src="https://cdn.nlark.com/yuque/0/2021/png/2040418/1637240476304-dad60ae7-671a-4832-bfa1-61d51dd4265e.png" alt="img"></p>
<table>
<thead>
<tr>
<th>函数</th>
<th>用法</th>
</tr>
</thead>
<tbody><tr>
<td>ADDTIME(time1,time2)</td>
<td>返回time1加上time2的时间。当time2为一个数字时，代表的是 秒 ，可以为负数</td>
</tr>
<tr>
<td>SUBTIME(time1,time2)</td>
<td>返回time1减去time2后的时间。当time2为一个数字时，代表的 是 秒 ，可以为负数</td>
</tr>
<tr>
<td>DATEDIFF(date1,date2)</td>
<td>返回date1 - date2的日期间隔天数</td>
</tr>
<tr>
<td>TIMEDIFF(time1, time2)</td>
<td>返回time1 - time2的时间间隔</td>
</tr>
<tr>
<td>FROM_DAYS(N)</td>
<td>返回从0000年1月1日起，N天以后的日期</td>
</tr>
<tr>
<td>TO_DAYS(date)</td>
<td>返回日期date距离0000年1月1日的天数</td>
</tr>
<tr>
<td>LAST_DAY(date)</td>
<td>返回date所在月份的最后一天的日期</td>
</tr>
<tr>
<td>MAKEDATE(year,n)</td>
<td>针对给定年份与所在年份中的天数返回一个日期</td>
</tr>
<tr>
<td>MAKETIME(hour,minute,second)</td>
<td>将给定的小时、分钟和秒组合成时间并返回</td>
</tr>
<tr>
<td>PERIOD_ADD(time,n)</td>
<td>返回time加上n后的时间</td>
</tr>
</tbody></table>
<h4 id="日期的格式化与解析"><a href="#日期的格式化与解析" class="headerlink" title="日期的格式化与解析"></a>日期的格式化与解析</h4><table>
<thead>
<tr>
<th>函数</th>
<th>用法</th>
</tr>
</thead>
<tbody><tr>
<td>DATE_FORMAT(date,fmt)</td>
<td>按照字符串fmt格式化日期date值</td>
</tr>
<tr>
<td>TIME_FORMAT(time,fmt)</td>
<td>按照字符串fmt格式化时间time值</td>
</tr>
<tr>
<td>GET_FORMAT(date_type,format_type)</td>
<td>返回日期字符串的显示格式</td>
</tr>
<tr>
<td>STR_TO_DATE(str, fmt)</td>
<td>按照字符串fmt对str进行解析，解析为一个日期</td>
</tr>
</tbody></table>
<p> 上述 非<code>GET_FORMAT</code> 函数中fmt参数常用的格式符： </p>
<table>
<thead>
<tr>
<th>格 式 符</th>
<th>说明</th>
<th>格式 符</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>%Y</td>
<td>4位数字表示年份</td>
<td>%y</td>
<td>表示两位数字表示年份</td>
</tr>
<tr>
<td>%M</td>
<td>月名表示月份（January,….）</td>
<td>%m</td>
<td>两位数字表示月份 （01,02,03。。。）</td>
</tr>
<tr>
<td>%b</td>
<td>缩写的月名（Jan.，Feb.，….）</td>
<td>%c</td>
<td>数字表示月份（1,2,3,…）</td>
</tr>
<tr>
<td>%D</td>
<td>英文后缀表示月中的天数 （1st,2nd,3rd,…）</td>
<td>%d</td>
<td>两位数字表示月中的天数(01,02…)</td>
</tr>
<tr>
<td>%e</td>
<td>数字形式表示月中的天数 （1,2,3,4,5…..）</td>
<td></td>
<td></td>
</tr>
<tr>
<td>%H</td>
<td>两位数字表示小数，24小时制 （01,02..）</td>
<td>%h 和%I</td>
<td>两位数字表示小时，12小时制 （01,02..）</td>
</tr>
<tr>
<td>%k</td>
<td>数字形式的小时，24小时制(1,2,3)</td>
<td>%l</td>
<td>数字形式表示小时，12小时制 （1,2,3,4….）</td>
</tr>
<tr>
<td>%i</td>
<td>两位数字表示分钟（00,01,02）</td>
<td>%S 和%s</td>
<td>两位数字表示秒(00,01,02…)</td>
</tr>
<tr>
<td>%W</td>
<td>一周中的星期名称（Sunday…）</td>
<td>%a</td>
<td>一周中的星期缩写（Sun.， Mon.,Tues.，..）</td>
</tr>
<tr>
<td>%w</td>
<td>以数字表示周中的天数 (0&#x3D;Sunday,1&#x3D;Monday….)</td>
<td></td>
<td></td>
</tr>
<tr>
<td>%j</td>
<td>以3位数字表示年中的天数(001,002…)</td>
<td>%U</td>
<td>以数字表示年中的第几周， （1,2,3。。）其中Sunday为周中第一 天</td>
</tr>
<tr>
<td>%u</td>
<td>以数字表示年中的第几周， （1,2,3。。）其中Monday为周中第一 天</td>
<td></td>
<td></td>
</tr>
<tr>
<td>%T</td>
<td>24小时制</td>
<td>%r</td>
<td>12小时制</td>
</tr>
<tr>
<td>%p</td>
<td>AM或PM</td>
<td>%%</td>
<td>表示%</td>
</tr>
</tbody></table>
<p> <code>GET_FORMAT</code>函数中<code>date_type</code>和<code>format_type</code>参数取值如下<br> <img src="https://cdn.nlark.com/yuque/0/2021/png/2040418/1637240589899-86dd22d8-6326-4738-b3e4-6888df22819e.png" alt="img"></p>
<h3 id="流程控制函数"><a href="#流程控制函数" class="headerlink" title="流程控制函数"></a>流程控制函数</h3><table>
<thead>
<tr>
<th>函数</th>
<th>用法</th>
</tr>
</thead>
<tbody><tr>
<td>IF(value,value1,value2)</td>
<td>如果value的值为TRUE，返回value1， 否则返回value2</td>
</tr>
<tr>
<td>IFNULL(value1, value2)</td>
<td>如果value1不为NULL，返回value1，否 则返回value2</td>
</tr>
<tr>
<td>CASE WHEN 条件1 THEN 结果1 WHEN 条件2 THEN 结果2 …. [ELSE resultn] END</td>
<td>相当于Java的if…else if…else…</td>
</tr>
<tr>
<td>CASE expr WHEN 常量值1 THEN 值1 WHEN 常量值1 THEN 值1 …. [ELSE 值n] END</td>
<td>相当于Java的switch…case…</td>
</tr>
</tbody></table>
<h3 id="加密解密函数"><a href="#加密解密函数" class="headerlink" title="加密解密函数"></a>加密解密函数</h3><table>
<thead>
<tr>
<th>函数</th>
<th>用法</th>
</tr>
</thead>
<tbody><tr>
<td>PASSWORD(str)</td>
<td>返回字符串str的加密版本，41位长的字符串。加密结果 不可 逆 ，常用于用户的密码加密</td>
</tr>
<tr>
<td>MD5(str)</td>
<td>返回字符串str的md5加密后的值，也是一种加密方式。若参数为 NULL，则会返回NULL</td>
</tr>
<tr>
<td>SHA(str)</td>
<td>从原明文密码str计算并返回加密后的密码字符串，当参数为 NULL时，返回NULL。 SHA加密算法比MD5更加安全 。</td>
</tr>
<tr>
<td>ENCODE(value,password_seed)</td>
<td>返回使用password_seed作为加密密码加密value</td>
</tr>
<tr>
<td>DECODE(value,password_seed)</td>
<td>返回使用password_seed作为加密密码解密value</td>
</tr>
</tbody></table>
<p><code>PASSWORD(str)、ENCODE(value,password_seed) 、DECODE(value,password_seed) </code>在MySQL8.0中已弃用</p>
<h3 id="MySQL信息函数"><a href="#MySQL信息函数" class="headerlink" title="MySQL信息函数"></a>MySQL信息函数</h3><table>
<thead>
<tr>
<th>函数</th>
<th>用法</th>
</tr>
</thead>
<tbody><tr>
<td>VERSION()</td>
<td>返回当前MySQL的版本号</td>
</tr>
<tr>
<td>CONNECTION_ID()</td>
<td>返回当前MySQL服务器的连接数</td>
</tr>
<tr>
<td>DATABASE()，SCHEMA()</td>
<td>返回MySQL命令行当前所在的数据库</td>
</tr>
<tr>
<td>USER()，CURRENT_USER()、SYSTEM_USER()， SESSION_USER()</td>
<td>返回当前连接MySQL的用户名，返回结果格式为 “主机名@用户名”</td>
</tr>
<tr>
<td>CHARSET(value)</td>
<td>返回字符串value自变量的字符集</td>
</tr>
<tr>
<td>COLLATION(value)</td>
<td>返回字符串value的比较规则</td>
</tr>
</tbody></table>
<h3 id="参考文献-1"><a href="#参考文献-1" class="headerlink" title="参考文献"></a>参考文献</h3><p><a target="_blank" rel="noopener" href="https://www.yuque.com/attachments/yuque/0/2021/pdf/2040418/1637236469937-3241dea1-a8c6-455b-9cd3-1d61b082ce62.pdf">📎第07章_单行函数.pdf</a></p>
<h2 id="第09章：聚合函数【多行函数】"><a href="#第09章：聚合函数【多行函数】" class="headerlink" title="第09章：聚合函数【多行函数】"></a>第09章：聚合函数【多行函数】</h2><h3 id="1-聚合函数"><a href="#1-聚合函数" class="headerlink" title="1 聚合函数"></a>1 聚合函数</h3><p>聚合函数作用于一组数据，并对一组数据返回一个值 </p>
<p><img src="https://cdn.nlark.com/yuque/0/2021/png/2040418/1637289312967-b2d640a1-c673-46d0-8047-1ce1f3f2081a.png" alt="img"></p>
<h4 id="1-1-AVG和SUM函数"><a href="#1-1-AVG和SUM函数" class="headerlink" title="1.1 AVG和SUM函数"></a>1.1 AVG和SUM函数</h4><p>可以对数值型数据使用AVG 和 SUM 函数<br> <code>null</code>值不会计算在内</p>
<h4 id="1-2-MIN和MAX函数"><a href="#1-2-MIN和MAX函数" class="headerlink" title="1.2 MIN和MAX函数"></a>1.2 MIN和MAX函数</h4><p>可以对任意数据类型的数据使用 MIN 和 MAX 函数 </p>
<h4 id="1-3-COUNT函数"><a href="#1-3-COUNT函数" class="headerlink" title="1.3 COUNT函数"></a>1.3 COUNT函数</h4><ul>
<li>COUNT(*)返回表中记录总数，适用于任意数据类型 </li>
<li>COUNT(expr) 返回expr不为空的记录总数</li>
</ul>
<p>不能计算<code>null</code>值</p>
<p>如果需要统计表中的记录数，使用COUNT(* )、COUNT (1)、COUNT (具体字段)哪个效率更高呢?</p>
<ul>
<li>如果使用的是MyISAM存储引擎，则三者效率相同，都是O(1)</li>
<li>如果使用的是InnoDB存储引擎，则三者效率:COUNT(*) &#x3D; COUNT(1)&gt; COUNT(字段)</li>
</ul>
<h3 id="2-group-by"><a href="#2-group-by" class="headerlink" title="2 group by"></a>2 group by</h3><p>顺序问题：</p>
<pre><code>select` &gt; `where`&gt; `group by`&gt;`order by` &gt;`limit
SELECT column, group_function(column)
FROM table
[WHERE condition]
[GROUP BY group_by_expression]
[ORDER BY column];
</code></pre>
<ul>
<li><p>单列分组</p>
</li>
<li><p>多列分组 </p>
</li>
<li><p>WITH ROLLUP</p>
</li>
</ul>
<p>使用 WITH ROLLUP 关键字之后，在所有查询出的分组记录之后增加一条记录，该记录计算查询出的所有记录的总和，即统计记录数量<br>注意：<br>当使用<code>ROLLUP</code>时，不能同时使用ORDER BY子句进行结果排序，即ROLLUP和ORDER BY是互相排斥的。 </p>
<h3 id="3-having"><a href="#3-having" class="headerlink" title="3 having"></a>3 having</h3><ul>
<li><p>当出现组合函数<code>group by</code>或者聚合函数，则必须使用<code>having</code>来替换<code>where</code>，并且<code>having</code>需要声明在<code>group by</code>的后面。否则会报错。</p>
</li>
<li><p>当过滤条件没有聚合函数，则此过滤条件可以声明在<code>having</code>来替换<code>where</code>中，建议声明在&#96;&#96;&#96;where&#96;中。</p>
</li>
<li><p>非法使用聚合函数 ： 不能在 WHERE 子句中使用聚合函数</p>
</li>
</ul>
<h3 id="4-SQL底层执行原理"><a href="#4-SQL底层执行原理" class="headerlink" title="4 SQL底层执行原理"></a>4 SQL底层执行原理</h3><h4 id="4-1-SELECT语句的完整结构"><a href="#4-1-SELECT语句的完整结构" class="headerlink" title="4.1 SELECT语句的完整结构"></a>4.1 SELECT语句的完整结构</h4><pre class="line-numbers language-sql"><code class="language-sql"><span class="token comment" spellcheck="true">#sql92语法：</span>
<span class="token keyword">SELECT</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">(</span>存在聚合函数<span class="token punctuation">)</span>
<span class="token keyword">FROM</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token keyword">WHERE</span> 多表的连接条件 <span class="token operator">AND</span> 不包含聚合函数的过滤条件
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token keyword">HAVING</span> 包含聚合函数的过滤条件
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">(</span><span class="token keyword">ASC</span> <span class="token operator">/</span> <span class="token keyword">DESC</span> <span class="token punctuation">)</span>
<span class="token keyword">LIMIT</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>


<span class="token comment" spellcheck="true">#sql99语法：</span>
<span class="token keyword">SELECT</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">(</span>存在聚合函数<span class="token punctuation">)</span>
<span class="token keyword">FROM</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">(</span><span class="token keyword">LEFT</span> <span class="token operator">/</span> <span class="token keyword">RIGHT</span><span class="token punctuation">)</span><span class="token keyword">JOIN</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token keyword">ON</span> 多表的连接条件 
<span class="token punctuation">(</span><span class="token keyword">LEFT</span> <span class="token operator">/</span> <span class="token keyword">RIGHT</span><span class="token punctuation">)</span><span class="token keyword">JOIN</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token keyword">ON</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token keyword">WHERE</span> 不包含聚合函数的过滤条件
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token keyword">HAVING</span> 包含聚合函数的过滤条件
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">(</span><span class="token keyword">ASC</span> <span class="token operator">/</span> <span class="token keyword">DESC</span> <span class="token punctuation">)</span>
<span class="token keyword">LIMIT</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="4-2-SQL语句的执行顺序"><a href="#4-2-SQL语句的执行顺序" class="headerlink" title="4.2 SQL语句的执行顺序"></a>4.2 SQL语句的执行顺序</h4><pre class="line-numbers language-sql"><code class="language-sql"><span class="token comment" spellcheck="true">#FROM ...,...-> ON -> (LEFT/RIGNT  JOIN) -> WHERE -> GROUP BY -> HAVING -> SELECT -> DISTINCT -> </span>
<span class="token comment" spellcheck="true"># ORDER BY -> LIMIT</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h3 id="参考文献-2"><a href="#参考文献-2" class="headerlink" title="参考文献"></a>参考文献</h3><p><a target="_blank" rel="noopener" href="https://www.yuque.com/attachments/yuque/0/2021/pdf/2040418/1637236674897-ad3e6bf2-cc37-4ca3-bf3b-e2f17f12357f.pdf">📎第08章_聚合函数.pdf</a></p>
<h2 id=""><a href="#" class="headerlink" title=""></a></h2><h1 id="SQL之DDL、DML、DCL使用篇"><a href="#SQL之DDL、DML、DCL使用篇" class="headerlink" title="SQL之DDL、DML、DCL使用篇"></a>SQL之DDL、DML、DCL使用篇</h1><ul>
<li><p><strong>DDL</strong>（Data Definition Languages、数据定义语言）</p>
</li>
<li><ul>
<li>这些语句定义了不同的数据库、表、视图、索引等数据库对象，还可以用来创建、删除、修改数据库和数据表的结构。</li>
<li>主要的语句<strong>关键字</strong>包括 CREATE 、RENAME、TRUNCATE、 DROP 、 ALTER 等。</li>
</ul>
</li>
<li><p><strong>DML</strong>（Data Manipulation Language、数据操作语言）</p>
</li>
<li><ul>
<li>用于添加、删除、更新和查询数据库记录，并检查数据完整性。</li>
<li>主要的语句<strong>关键字</strong>包括 INSERT 、 DELETE 、 UPDATE 、 SELECT 等。</li>
</ul>
</li>
<li><p><strong>DCL</strong>（Data Control Language、数据控制语言）</p>
</li>
<li><ul>
<li>用于定义数据库、表、字段、用户的访问权限和安全级别。</li>
<li>主要的语句<strong>关键字</strong>包括 GRANT 、 REVOKE 、 COMMIT 、 ROLLBACK 、 SAVEPOINT 等。</li>
</ul>
</li>
</ul>
<p>因为查询语句使用的非常的频繁，所以很多人把查询语句单拎出来一类：DQL（数据查询语言）。<br>还有单独将 COMMIT 、 ROLLBACK 取出来称为TCL （Transaction Control Language，事务控制语言）。 </p>
<h2 id="第10章：创建和管理表【DDL】"><a href="#第10章：创建和管理表【DDL】" class="headerlink" title="第10章：创建和管理表【DDL】"></a>第10章：创建和管理表【DDL】</h2><h3 id="命名规则"><a href="#命名规则" class="headerlink" title="命名规则"></a>命名规则</h3><ul>
<li><p>数据库名、表名不得超过30个字符，变量名限制为29个</p>
</li>
<li><p>必须只能包含 A–Z, a–z, 0–9, _共63个字符</p>
</li>
<li><p>数据库名、表名、字段名等对象名中间不要包含空格</p>
</li>
<li><p>同一个MySQL软件中，数据库不能同名；同一个库中，表不能重名；同一个表中，字段不能重名</p>
</li>
<li><p>必须保证你的字段没有和保留字、数据库系统或常用方法冲突。如果坚持使用，请在SQL语句中使用&#96;（着重号）引起来</p>
</li>
<li><p>保持字段名和类型的一致性：在命名字段并为其指定数据类型的时候一定要保证一致性，假如数据</p>
</li>
<li><p>类型在一个表里是整数，那在另一个表里可就别变成字符型了</p>
</li>
</ul>
<h3 id="创建和管理数据库"><a href="#创建和管理数据库" class="headerlink" title="创建和管理数据库"></a>创建和管理数据库</h3><p><strong>创建</strong></p>
<ul>
<li>创建数据库</li>
</ul>
<pre><code>CREATE DATABASE IF NOT EXISTS 数据库名 CHARACTER SET 字符集;
</code></pre>
<p><strong>查看</strong></p>
<ul>
<li>查看当前所有的数据库</li>
</ul>
<pre><code>SHOW DATABASES;
</code></pre>
<ul>
<li>查看数据库的创建信息<br><code> SHOW CREATE DATABASE 数据库名;或者SHOW CREATE DATABASE 数据库名\G</code> </li>
<li>查看指定库下所有的表</li>
</ul>
<pre><code>SHOW TABLES FROM 数据库名; 
</code></pre>
<ul>
<li>查看当前正在使用的数据库<br><code>SELECT DATABASE();</code></li>
</ul>
<p><strong>修改</strong></p>
<pre><code>ALTER DATABASE 数据库名 CHARACTER SET 字符集; #比如：gbk、utf8等
</code></pre>
<p><strong>删除</strong> </p>
<pre><code>DROP DATABASE IF EXISTS 数据库名; 
</code></pre>
<h3 id="创建和管理表"><a href="#创建和管理表" class="headerlink" title="创建和管理表"></a>创建和管理表</h3><p><strong>常用类型</strong></p>
<table>
<thead>
<tr>
<th>数据类型</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>INT</td>
<td>从-2^31到2^31-1的整型数据。存储大小为 4个字节</td>
</tr>
<tr>
<td>CHAR(size)</td>
<td>定长字符数据。若未指定，默认为1个字符，最大长度255</td>
</tr>
<tr>
<td>VARCHAR(size)</td>
<td>可变长字符数据，根据字符串实际长度保存，必须指定长度</td>
</tr>
<tr>
<td>FLOAT(M,D)</td>
<td>单精度，占用4个字节，M&#x3D;整数位+小数位，D&#x3D;小数位。 D&lt;&#x3D;M&lt;&#x3D;255,0&lt;&#x3D;D&lt;&#x3D;30， 默认M+D&lt;&#x3D;6</td>
</tr>
<tr>
<td>DOUBLE(M,D)</td>
<td>双精度，占用8个字节，D&lt;&#x3D;M&lt;&#x3D;255,0&lt;&#x3D;D&lt;&#x3D;30，默认M+D&lt;&#x3D;15</td>
</tr>
<tr>
<td>DECIMAL(M,D)</td>
<td>高精度小数，占用M+2个字节，D&lt;&#x3D;M&lt;&#x3D;65，0&lt;&#x3D;D&lt;&#x3D;30，最大取值范围与DOUBLE 相同。</td>
</tr>
<tr>
<td>DATE</td>
<td>日期型数据，格式’YYYY-MM-DD’</td>
</tr>
<tr>
<td>BLOB</td>
<td>二进制形式的长文本数据，最大可达4G</td>
</tr>
<tr>
<td>TEXT</td>
<td>长文本数据，最大可达4G</td>
</tr>
</tbody></table>
<h4 id="创建表"><a href="#创建表" class="headerlink" title="创建表"></a>创建表</h4><pre><code>create table 表名
</code></pre>
<ol>
<li>初始创建</li>
<li>通过已有表创建，会包含已有表的数据  使用<code>AS</code>+ 查询语句</li>
</ol>
<p><code>SHOW CREATE TABLE 表名\G </code> 查看表的结构</p>
<h4 id="修改表"><a href="#修改表" class="headerlink" title="修改表"></a>修改表</h4><pre><code>alter tabel 表名
</code></pre>
<p><strong>添加一个字段</strong></p>
<pre><code>ADD
ALTER TABLE 表名 ADD 【COLUMN】 字段名 字段类型 【FIRST|AFTER 字段名】;

ALTER TABLE dept80
ADD job_id varchar(15);
</code></pre>
<p><strong>修改一个字段</strong></p>
<pre><code>MODIFY
ALTER TABLE 表名 MODIFY 【COLUMN】 字段名1 字段类型 【DEFAULT 默认值】【FIRST|AFTER 字段名
2】;


ALTER TABLE dept80
MODIFY last_name VARCHAR(30);
</code></pre>
<p><strong>重命名一个字段</strong></p>
<pre><code>change
ALTER TABLE 表名 CHANGE 【column】 列名 新列名 新数据类型;

ALTER TABLE dept80
CHANGE department_name dept_name varchar(15);
</code></pre>
<p><strong>删除一个字段</strong></p>
<pre><code>drop
ALTER TABLE 表名 DROP 【COLUMN】字段名

ALTER TABLE dept80
DROP COLUMN job_id;
</code></pre>
<p><strong>重命名表</strong></p>
<pre><code>rename
# 方式一
ALTER table dept
RENAME [TO] detail_dept; -- [TO]可以省略

# 方式二
RENAME TABLE emp
TO myemp;
</code></pre>
<h4 id="删除表"><a href="#删除表" class="headerlink" title="删除表"></a>删除表</h4><pre><code>drop tabel
DROP TABLE [IF EXISTS] 数据表1 [, 数据表2, …, 数据表n];

DROP TABLE dept80;
</code></pre>
<p>表结构和表数据删除</p>
<h4 id="清空表"><a href="#清空表" class="headerlink" title="清空表"></a>清空表</h4><pre><code>truncate tabel
TRUNCATE TABLE detail_dept;
</code></pre>
<p>只删除表数据。</p>
<p>TRUNCATE语句不能回滚，而使用 DELETE 语句删除数据，可以回滚 </p>
<p><strong>DDL 和 DML 的说明</strong></p>
<p>① DDL的操作一旦执行，就不可回滚。指令SET autocommit &#x3D; FALSE对DDL操作失效。(因为在执行完DDL操作之后，一定<strong>会执行一次COMMIT</strong>。而此COMMIT操作不受SET autocommit &#x3D; FALSE影响的。)</p>
<p>② DML的操作默认情况，一旦执行，也是不可回滚的。但是，如果在执行DML之前，执行了SET autocommit &#x3D; FALSE，则执行的DML操作就可以实现回滚。</p>
<p><a target="_blank" rel="noopener" href="https://www.yuque.com/attachments/yuque/0/2021/pdf/2040418/1637398612195-784774df-a8e2-4496-97ce-c437dec5e565.pdf">📎第10章_创建和管理表.pdf</a></p>
<h2 id="第11章：数据处理之增删改【DML】"><a href="#第11章：数据处理之增删改【DML】" class="headerlink" title="第11章：数据处理之增删改【DML】"></a>第11章：数据处理之增删改【DML】</h2><h3 id="插入数据"><a href="#插入数据" class="headerlink" title="插入数据"></a>插入数据</h3><pre><code>inset into
</code></pre>
<h4 id="values添加"><a href="#values添加" class="headerlink" title="values添加"></a>values添加</h4><p>字符和日期型数据应包含在单引号中 </p>
<pre class="line-numbers language-sql"><code class="language-sql"><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> 表名
<span class="token keyword">VALUES</span> <span class="token punctuation">(</span>value1<span class="token punctuation">,</span>value2<span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true"># 方式一 需要知道各个字段的位置</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> departments
<span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">70</span><span class="token punctuation">,</span> <span class="token string">'Pub'</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">1700</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true"># 方式二 指定字段插入数据</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> 表名<span class="token punctuation">(</span>column1 <span class="token punctuation">[</span><span class="token punctuation">,</span> column2<span class="token punctuation">,</span> …<span class="token punctuation">,</span> columnn<span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">VALUES</span> <span class="token punctuation">(</span>value1 <span class="token punctuation">[</span><span class="token punctuation">,</span>value2<span class="token punctuation">,</span> …<span class="token punctuation">,</span> valuen<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> departments<span class="token punctuation">(</span>department_id<span class="token punctuation">,</span> department_name<span class="token punctuation">)</span>
<span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">80</span><span class="token punctuation">,</span> <span class="token string">'IT'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true"># 方式三 同时插入多条记录</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> table_name
<span class="token keyword">VALUES</span>
<span class="token punctuation">(</span>value1 <span class="token punctuation">[</span><span class="token punctuation">,</span>value2<span class="token punctuation">,</span> …<span class="token punctuation">,</span> valuen<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span>value1 <span class="token punctuation">[</span><span class="token punctuation">,</span>value2<span class="token punctuation">,</span> …<span class="token punctuation">,</span> valuen<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
……
<span class="token punctuation">(</span>value1 <span class="token punctuation">[</span><span class="token punctuation">,</span>value2<span class="token punctuation">,</span> …<span class="token punctuation">,</span> valuen<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true"># 或者</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> table_name<span class="token punctuation">(</span>column1 <span class="token punctuation">[</span><span class="token punctuation">,</span> column2<span class="token punctuation">,</span> …<span class="token punctuation">,</span> columnn<span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">VALUES</span>
<span class="token punctuation">(</span>value1 <span class="token punctuation">[</span><span class="token punctuation">,</span>value2<span class="token punctuation">,</span> …<span class="token punctuation">,</span> valuen<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span>value1 <span class="token punctuation">[</span><span class="token punctuation">,</span>value2<span class="token punctuation">,</span> …<span class="token punctuation">,</span> valuen<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
……
<span class="token punctuation">(</span>value1 <span class="token punctuation">[</span><span class="token punctuation">,</span>value2<span class="token punctuation">,</span> …<span class="token punctuation">,</span> valuen<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> emp<span class="token punctuation">(</span>emp_id<span class="token punctuation">,</span>emp_name<span class="token punctuation">)</span>
<span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span><span class="token string">'shkstart'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span><span class="token string">'atguigu'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1003</span><span class="token punctuation">,</span><span class="token string">'Tom'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>一个同时插入多行记录的INSERT语句等同于多个单行插入的INSERT语句，但是多行的INSERT语句在处理过程中 效率更高 。因为MySQL执行单条INSERT语句插入多行数据比使用多条INSERT语句快，所以在插入多条记录时最好选择使用单条INSERT语句的方式插入。 </p>
<h4 id="查询结果插入到新表"><a href="#查询结果插入到新表" class="headerlink" title="查询结果插入到新表"></a>查询结果插入到新表</h4><ul>
<li><p>在 INSERT 语句中加入子查询 </p>
</li>
<li><p>不必书写 VALUES 子句 </p>
</li>
<li><p>子查询中的值列表应与 INSERT 子句中的列名对应</p>
</li>
</ul>
<pre class="line-numbers language-sql"><code class="language-sql"><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> 目标表名
<span class="token punctuation">(</span>tar_column1 <span class="token punctuation">[</span><span class="token punctuation">,</span> tar_column2<span class="token punctuation">,</span> …<span class="token punctuation">,</span> tar_columnn<span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">SELECT</span>
<span class="token punctuation">(</span>src_column1 <span class="token punctuation">[</span><span class="token punctuation">,</span> src_column2<span class="token punctuation">,</span> …<span class="token punctuation">,</span> src_columnn<span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">FROM</span> 源表名
<span class="token punctuation">[</span><span class="token keyword">WHERE</span> condition<span class="token punctuation">]</span>


<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> emp2
<span class="token keyword">SELECT</span> <span class="token operator">*</span>
<span class="token keyword">FROM</span> employees
<span class="token keyword">WHERE</span> department_id <span class="token operator">=</span> <span class="token number">90</span><span class="token punctuation">;</span>


<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> sales_reps<span class="token punctuation">(</span>id<span class="token punctuation">,</span> name<span class="token punctuation">,</span> salary<span class="token punctuation">,</span> commission_pct<span class="token punctuation">)</span>
<span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span> last_name<span class="token punctuation">,</span> salary<span class="token punctuation">,</span> commission_pct
<span class="token keyword">FROM</span> employees
<span class="token keyword">WHERE</span> job_id <span class="token operator">LIKE</span> <span class="token string">'%REP%'</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="更新数据"><a href="#更新数据" class="headerlink" title="更新数据"></a>更新数据</h3><pre><code>update ... set ... where
</code></pre>
<ul>
<li><p>可以一次更新多条数据 </p>
</li>
<li><p>如果需要回滚数据，需要保证在DML前，进行设置：<code>SET AUTOCOMMIT = FALSE </code></p>
</li>
<li><p>使用 <code>WHERE</code>子句指定需要更新的数据</p>
</li>
</ul>
<pre class="line-numbers language-sql"><code class="language-sql"><span class="token keyword">UPDATE</span> table_name
<span class="token keyword">SET</span> column1<span class="token operator">=</span>value1<span class="token punctuation">,</span> column2<span class="token operator">=</span>value2<span class="token punctuation">,</span> … <span class="token punctuation">,</span> <span class="token keyword">column</span><span class="token operator">=</span>valuen
<span class="token punctuation">[</span><span class="token keyword">WHERE</span> condition<span class="token punctuation">]</span>


<span class="token keyword">UPDATE</span> employees
<span class="token keyword">SET</span> department_id <span class="token operator">=</span> <span class="token number">70</span>
<span class="token keyword">WHERE</span> employee_id <span class="token operator">=</span> <span class="token number">113</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="删除数据"><a href="#删除数据" class="headerlink" title="删除数据"></a>删除数据</h3><pre><code>delete from 
DELETE FROM table_name [WHERE &lt;condition&gt;];

DELETE FROM departments
WHERE department_name = &#39;Finance&#39;;


# 如果省略 WHERE 子句，则表中的全部数据将被删除
DELETE FROM copy_emp;
</code></pre>
<h3 id="参考文献-3"><a href="#参考文献-3" class="headerlink" title="参考文献"></a>参考文献</h3><p><a target="_blank" rel="noopener" href="https://www.yuque.com/attachments/yuque/0/2021/pdf/2040418/1637408500502-722c08f2-a18c-429e-89cb-66acb2720e41.pdf">📎第11章_数据处理之增删改.pdf</a></p>
<h2 id="第12章：MySQL数据类型精讲"><a href="#第12章：MySQL数据类型精讲" class="headerlink" title="第12章：MySQL数据类型精讲"></a>第12章：MySQL数据类型精讲</h2><ul>
<li><p>在定义数据类型时，如果确定是 整数 ，就用 <code>INT</code> ； </p>
</li>
<li><p>如果是 小数 ，一定用定点数类型<code>DECIMAL(M,D)</code> ； </p>
</li>
<li><p>如果是日期与时间，就用 <code>DATETIME</code> 。</p>
</li>
</ul>
<p>这样做的好处是，首先确保你的系统不会因为数据类型定义出错。不过，凡事都是有两面的，可靠性好，并不意味着高效。比如，<code>TEXT</code> 虽然使用方便，但是效率不如<code> CHAR(M)</code> 和 <code>VARCHAR(M)</code>。 </p>
<p><strong>阿里巴巴《Java开发手册》之MySQL数据库：</strong></p>
<ul>
<li><p>任何字段如果为非负数，必须是 UNSIGNED</p>
</li>
<li><p>【 强制 】小数类型为 DECIMAL，禁止使用 FLOAT 和 DOUBLE。</p>
</li>
<li><ul>
<li>说明：在存储的时候，FLOAT 和 DOUBLE 都存在精度损失的问题，很可能在比较值的时候，得到不正确的结果。如果存储的数据范围超过 DECIMAL 的范围，建议将数据拆成整数和小数并分开存储。</li>
</ul>
</li>
<li><p>【 强制 】如果存储的字符串长度几乎相等，使用 CHAR 定长字符串类型。</p>
</li>
<li><p>【 强制 】VARCHAR 是可变长字符串，不预先分配存储空间，长度不要超过 5000。如果存储长度大于此值，定义字段类型为 TEXT，独立出来一张表，用主键来对应，避免影响其它字段索引效率</p>
</li>
</ul>
<h3 id="MySQL中的数据类型"><a href="#MySQL中的数据类型" class="headerlink" title="MySQL中的数据类型"></a>MySQL中的数据类型</h3><table>
<thead>
<tr>
<th>类型</th>
<th>类型举例</th>
</tr>
</thead>
<tbody><tr>
<td>整数类型</td>
<td>TINYINT、SMALLINT、MEDIUMINT、INT(或INTEGER)、BIGINT</td>
</tr>
<tr>
<td>浮点类型</td>
<td>FLOAT、DOUBLE</td>
</tr>
<tr>
<td>定点数类型</td>
<td>DECIMAL</td>
</tr>
<tr>
<td>位类型</td>
<td>BIT</td>
</tr>
<tr>
<td>日期时间类型</td>
<td>YEAR、TIME、DATE、DATETIME、TIMESTAMP</td>
</tr>
<tr>
<td>文本字符串类型</td>
<td>CHAR、VARCHAR、TINYTEXT、TEXT、MEDIUMTEXT、LONGTEXT</td>
</tr>
<tr>
<td>枚举类型</td>
<td>ENUM</td>
</tr>
<tr>
<td>集合类型</td>
<td>SET</td>
</tr>
<tr>
<td>二进制字符串类 型</td>
<td>BINARY、VARBINARY、TINYBLOB、BLOB、MEDIUMBLOB、LONGBLOB</td>
</tr>
<tr>
<td>JSON类型</td>
<td>JSON对象、JSON数组</td>
</tr>
<tr>
<td>空间数据类型</td>
<td>单值类型：GEOMETRY、POINT、LINESTRING、POLYGON； 集合类型：MULTIPOINT、MULTILINESTRING、MULTIPOLYGON、 GEOMETRYCOLLECTION</td>
</tr>
</tbody></table>
<h3 id="整数类型"><a href="#整数类型" class="headerlink" title="整数类型"></a>整数类型</h3><p><code>TINYINT </code>：一般用于<strong>枚举数据</strong>，比如系统设定取值范围很小且固定的场景。<br><code>SMALLINT</code> ：可以用于<strong>较小范围的统计数据</strong>，比如统计工厂的固定资产库存数量等。<br><code>MEDIUMINT</code> ：用于<strong>较大整数</strong>的计算，比如车站每日的客流量等。<br><code>INT、INTEGER</code> ：取值范围足够大，一般情况下不用考虑超限问题，<strong>用得最多</strong>。比如商品编号。<br><code>BIGINT</code> ：只有当你处理<strong>特别巨大的整数</strong>时才会用到。比如双十一的交易量、大型门户网站点击量、证券公司衍生产品持仓等。</p>
<p>系统故障产生的成本远远超过增加几个字段存储空间所产生的成本 </p>
<p>首先确保数据不会超过取值范围，在这个前提之下，再去考虑如何节省存储空间 </p>
<table>
<thead>
<tr>
<th>整数类型</th>
<th>字节</th>
<th>有符号数取值范围</th>
<th>无符号数取值范围</th>
</tr>
</thead>
<tbody><tr>
<td>TINYINT</td>
<td>1</td>
<td>-128~127</td>
<td>0~255</td>
</tr>
<tr>
<td>SMALLINT</td>
<td>2</td>
<td>-32768~32767</td>
<td>0~65535</td>
</tr>
<tr>
<td>MEDIUMINT</td>
<td>3</td>
<td>-8388608~8388607</td>
<td>0~16777215</td>
</tr>
<tr>
<td>INT、INTEGER</td>
<td>4</td>
<td>-2147483648~2147483647</td>
<td>0~4294967295</td>
</tr>
<tr>
<td>BIGINT</td>
<td>8</td>
<td>-9223372036854775808~9223372036854775807</td>
<td>0~18446744073709551615</td>
</tr>
</tbody></table>
<ul>
<li>指定<strong>宽度</strong> <code>M</code></li>
</ul>
<p>可以指定数字的宽度用<code>M</code>表示，需要配合<code>zerofill</code> 使用。不足位用0填充。并且当数字宽度超过<code>M</code>时，默认按照数值原有宽度显示。</p>
<pre class="line-numbers language-sql"><code class="language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> test_int1 <span class="token punctuation">(</span> x <span class="token keyword">TINYINT</span><span class="token punctuation">(</span>M<span class="token punctuation">)</span><span class="token punctuation">,</span> y <span class="token keyword">SMALLINT</span><span class="token punctuation">,</span> z <span class="token keyword">MEDIUMINT</span><span class="token punctuation">,</span> m <span class="token keyword">INT</span><span class="token punctuation">,</span> n <span class="token keyword">BIGINT</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true"># mysql5 中表结构会显示宽度</span>
<span class="token comment" spellcheck="true"># mysql8 中不会显示</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<ul>
<li><strong>无符号</strong><code>unsigned</code> 。无符号最大宽度会少一位，原最高表示符号。</li>
<li><strong>零填充</strong><code>zerofull</code>: 某列是<code>ZEROFILL</code>，那么MySQL会自动为当前列添加<code>UNSIGNED</code>属性</li>
</ul>
<p><code>int(M)</code><strong>，必须和</strong><code>UNSIGNED</code> <code>ZEROFILL</code><strong>一起使用才有意义</strong> <strong>,否则当超过m时，按实际位数存储，并不再补零。</strong></p>
<h3 id="浮点类型"><a href="#浮点类型" class="headerlink" title="浮点类型"></a>浮点类型</h3><p><img src="https://cdn.nlark.com/yuque/0/2021/png/2040418/1637465490676-d0c397d2-831a-4fef-bcb4-73b903b6c05c.png" alt="img"></p>
<p>浮点数是不准确的，所以我们要避免使用“&#x3D;”来判断两个数是否相等 </p>
<p>小数超了就四舍五入，整数超了就会报错</p>
<h3 id="定点数类型"><a href="#定点数类型" class="headerlink" title="定点数类型"></a>定点数类型</h3><table>
<thead>
<tr>
<th>数据类型</th>
<th>字节数</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td>DECIMAL(M,D),DEC,NUMERIC</td>
<td>M+2字节</td>
<td>有效范围由M和D决定</td>
</tr>
</tbody></table>
<p>以<code>字符串</code>的形式进行存储,结果是精确的。<br> 有效的数据范围由M和D决定。</p>
<p><strong>浮点数 vs 定点数</strong> </p>
<ul>
<li><p>浮点数相对于定点数的优点是在长度一定的情况下，浮点类型取值范围大，但是不精准，适用于需要取值范围大，又可以容忍微小误差的科学计算场景（比如计算化学、分子建模、流体动力学等）</p>
</li>
<li><p>定点数类型取值范围相对小，但是精准，没有误差，适合于对精度要求极高的场景 （比如涉及金额计算的场景）</p>
</li>
</ul>
<h3 id="位类型"><a href="#位类型" class="headerlink" title="位类型"></a>位类型</h3><table>
<thead>
<tr>
<th>二进制字符串类型</th>
<th>长度</th>
<th>长度范围</th>
<th>占用空间</th>
</tr>
</thead>
<tbody><tr>
<td>BIT(M)</td>
<td>M</td>
<td>1 &lt;&#x3D; M &lt;&#x3D; 64</td>
<td>约为(M + 7)&#x2F;8个字节</td>
</tr>
</tbody></table>
<ul>
<li>使用<code>b+0</code>查询数据时，可以直接查询出存储的<strong>十进制数据</strong>的值 </li>
<li>默认是<strong>1位</strong>。当超过指定位数会出现错误</li>
</ul>
<h3 id="日期与时间类型"><a href="#日期与时间类型" class="headerlink" title="日期与时间类型"></a>日期与时间类型</h3><ul>
<li><p>用得最多的日期时间类型，就是 <code>DATETIME</code>  </p>
</li>
<li><p>一般存注册时间、商品发布时间等，不建议使用DATETIME存储，而是使用<code>时间戳</code> ，因为DATETIME虽然直观，但不便于计算。 </p>
</li>
<li><ul>
<li><code>时间戳</code>的使用 可以用<code>bigint </code>中 使用<code> select unix_timestamp()</code>添加</li>
</ul>
</li>
<li><p><code>YEAR</code> 类型通常用来表示<strong>年</strong></p>
</li>
<li><p><code>DATE </code>类型通常用来表示<strong>年、月、日</strong></p>
</li>
<li><p><code>TIME </code>类型通常用来表示<strong>时、分、秒</strong></p>
</li>
<li><p><code>DATETIME </code>类型通常用来表示<strong>年、月、日、时、分、秒</strong></p>
</li>
<li><p><code>TIMESTAMP </code>类型通常用来表示<strong>带时区的年、月、日、时、分、秒</strong></p>
</li>
</ul>
<p><strong>Date格式</strong>为 <code>YYYY-MM-DD </code></p>
<p>以 <code>YYYY-MM-DD </code>或 <code>YYYYMMDD</code> 格式表示的字符串日期，最小取值为1000-01-01，最大取值为9999-12-03。<code>YYYYMMDD</code>格式会被转化为YYYY-MM-DD格式。</p>
<p>以 YY-MM-DD 格式或者 YYMMDD 格式表示的字符串日期，此格式中，年份为两位数值或字符串满足YEAR类型的格式条件为：当年份取值为00到69时，会被转化为2000到2069；当年份取值为70到99时，会被转化为1970到1999。</p>
<p>使用 CURRENT_DATE() 或者 NOW() 函数，会插入当前系统的日期 </p>
<table>
<thead>
<tr>
<th>类型</th>
<th>名称</th>
<th>字 节</th>
<th>日期格式</th>
<th>最小值</th>
<th>最大值</th>
</tr>
</thead>
<tbody><tr>
<td>YEAR</td>
<td>年</td>
<td>1</td>
<td>YYYY或YY</td>
<td>1901</td>
<td>2155</td>
</tr>
<tr>
<td>TIME</td>
<td>时间</td>
<td>3</td>
<td>HH:MM:SS</td>
<td>-838:59:59</td>
<td>838:59:59</td>
</tr>
<tr>
<td>DATE</td>
<td>日期</td>
<td>3</td>
<td>YYYY-MM-DD</td>
<td>1000-01-01</td>
<td>9999-12-03</td>
</tr>
<tr>
<td>DATETIME</td>
<td>日期 时间</td>
<td>8</td>
<td>YYYY-MM-DD HH:MM:SS</td>
<td>1000-01-01 00:00:00</td>
<td>9999-12-31 23:59:59</td>
</tr>
<tr>
<td>TIMESTAMP</td>
<td>日期 时间</td>
<td>4</td>
<td>YYYY-MM-DD HH:MM:SS</td>
<td>1970-01-01 00:00:00 UTC</td>
<td>2038-01-19 03:14:07UTC</td>
</tr>
</tbody></table>
<h3 id="文本字符串类型"><a href="#文本字符串类型" class="headerlink" title="文本字符串类型"></a>文本字符串类型</h3><h4 id="char和varchar类型"><a href="#char和varchar类型" class="headerlink" title="char和varchar类型"></a>char和varchar类型</h4><p><img src="https://cdn.nlark.com/yuque/0/2021/png/2040418/1637468228155-fb8dd343-765b-4e66-b70f-f000e979d7f4.png" alt="img"></p>
<p>char 默认长度为1</p>
<p>varchar 必须指定长度</p>
<table>
<thead>
<tr>
<th>类型</th>
<th>特点</th>
<th>空间上</th>
<th>时间上</th>
<th>适用场景</th>
</tr>
</thead>
<tbody><tr>
<td>CHAR(M)</td>
<td>固定长度</td>
<td>浪费存储空间</td>
<td>效率高</td>
<td>存储不大，速度要求高</td>
</tr>
<tr>
<td>VARCHAR(M)</td>
<td>可变长度</td>
<td>节省存储空间</td>
<td>效率低</td>
<td>非CHAR的情况</td>
</tr>
</tbody></table>
<p> <strong>哪些情况使用</strong> <code>**CHAR**</code> <strong>或</strong> <code>**VARCHAR**</code> <strong>更好</strong> </p>
<ul>
<li><p>存储很短的信息</p>
</li>
<li><p>固定长度</p>
</li>
<li><p>十分频繁改变的column</p>
</li>
<li><p>根据存储引擎</p>
</li>
<li><ul>
<li><code>MyISAM</code>，使用固定长度(<code>CHAR</code>) </li>
<li><code>MEMORY</code>, 使用固定长度的数据行存储。都处理为<code>char</code>类型</li>
</ul>
</li>
<li><ul>
<li><code>InnoDB</code>，建议使用<code>VARCHAR</code>类型</li>
</ul>
</li>
</ul>
<h4 id="text类型"><a href="#text类型" class="headerlink" title="text类型"></a>text类型</h4><p>由于实际存储的长度不确定，MySQL 不允许 TEXT 类型的字段做主键。遇到这种情况，你只能采用<code>CHAR(M)</code>，或者 <code>VARCHAR(M)</code>。 </p>
<p>不是特别大的内容，建议使用CHAR，VARCHAR来代替 </p>
<p>频繁使用的表不建议包含<strong>TEXT</strong>类型字段 </p>
<table>
<thead>
<tr>
<th>文本字符串类 型</th>
<th>特点</th>
<th>长 度</th>
<th>长度范围</th>
<th>占用的存储空 间</th>
</tr>
</thead>
<tbody><tr>
<td>TINYTEXT</td>
<td>小文本、可变长 度</td>
<td>L</td>
<td>0 &lt;&#x3D; L &lt;&#x3D; 255</td>
<td>L + 2 个字节</td>
</tr>
<tr>
<td>TEXT</td>
<td>文本、可变长度</td>
<td>L</td>
<td>0 &lt;&#x3D; L &lt;&#x3D; 65535</td>
<td>L + 2 个字节</td>
</tr>
<tr>
<td>MEDIUMTEXT</td>
<td>中等文本、可变 长度</td>
<td>L</td>
<td>0 &lt;&#x3D; L &lt;&#x3D; 16777215</td>
<td>L + 3 个字节</td>
</tr>
<tr>
<td>LONGTEXT</td>
<td>大文本、可变长 度</td>
<td>L</td>
<td>0 &lt;&#x3D; L&lt;&#x3D; 4294967295（相当于 4GB）</td>
<td>L + 4 个字节</td>
</tr>
</tbody></table>
<h3 id="ENUM类型"><a href="#ENUM类型" class="headerlink" title="ENUM类型"></a>ENUM类型</h3><table>
<thead>
<tr>
<th>文本字符串类型</th>
<th>长度</th>
<th>长度范围</th>
<th>占用的存储空间</th>
</tr>
</thead>
<tbody><tr>
<td>ENUM</td>
<td>L</td>
<td>1 &lt;&#x3D; L &lt;&#x3D; 65535</td>
<td>1或2个字节</td>
</tr>
</tbody></table>
<pre class="line-numbers language-sql"><code class="language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> test_enum<span class="token punctuation">(</span>
season <span class="token keyword">ENUM</span><span class="token punctuation">(</span><span class="token string">'春'</span><span class="token punctuation">,</span><span class="token string">'夏'</span><span class="token punctuation">,</span><span class="token string">'秋'</span><span class="token punctuation">,</span><span class="token string">'冬'</span><span class="token punctuation">,</span><span class="token string">'unknow'</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true"># 添加数据</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> test_enum
<span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'春'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token string">'秋'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true"># 忽略大小写</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> test_enum
<span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'UNKNOW'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true"># 允许按照角标的方式获取指定索引位置的枚举值</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> test_enum
<span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'1'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true"># Data truncated for column 'season' at row 1</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> test_enum
<span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'ab'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true"># 当ENUM类型的字段没有声明为NOT NULL时，插入NULL也是有效的</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> test_enum
<span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="SET类型"><a href="#SET类型" class="headerlink" title="SET类型"></a>SET类型</h3><p>可以包含0个或多个成员，但成员个数的上限为 64  </p>
<table>
<thead>
<tr>
<th><strong>成员个数范围（<strong><strong>L</strong></strong>表示实际成员个数）</strong></th>
<th><strong>占用的存储空间</strong></th>
</tr>
</thead>
<tbody><tr>
<td>1 &lt;&#x3D; L &lt;&#x3D; 8</td>
<td>1个字节</td>
</tr>
<tr>
<td>9 &lt;&#x3D; L &lt;&#x3D; 16</td>
<td>2个字节</td>
</tr>
<tr>
<td>17 &lt;&#x3D; L &lt;&#x3D; 24</td>
<td>3个字节</td>
</tr>
<tr>
<td>25 &lt;&#x3D; L &lt;&#x3D; 32</td>
<td>4个字节</td>
</tr>
<tr>
<td>33 &lt;&#x3D; L &lt;&#x3D; 64</td>
<td>8个字节</td>
</tr>
</tbody></table>
<pre class="line-numbers language-sql"><code class="language-sql"><span class="token comment" spellcheck="true"># 创建表</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> test_set<span class="token punctuation">(</span>
s <span class="token keyword">SET</span> <span class="token punctuation">(</span><span class="token string">'A'</span><span class="token punctuation">,</span> <span class="token string">'B'</span><span class="token punctuation">,</span> <span class="token string">'C'</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> test_set <span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">'A'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'A,B'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">#插入重复的SET类型成员时，MySQL会自动删除重复的成员</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> test_set <span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">'A,B,C,A'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">#向SET类型的字段插入SET成员中不存在的值时，MySQL会抛出错误。</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> test_set <span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">'A,B,C,D'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span>
<span class="token keyword">FROM</span> test_set<span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="二进制字符串类型"><a href="#二进制字符串类型" class="headerlink" title="二进制字符串类型"></a>二进制字符串类型</h3><h4 id="BINARY与VARBINARY类型"><a href="#BINARY与VARBINARY类型" class="headerlink" title="BINARY与VARBINARY类型"></a>BINARY与VARBINARY类型</h4><p><code>BINARY</code>和<code>VARBINARY</code>类似于<code>CHAR</code>和<code>VARCHAR</code>，只是它们<strong>存储的是二进制字符串。</strong> </p>
<ul>
<li><code>BINARY (M)</code>为固定长度的二进制字符串。<code>M</code>为最大存储字节数，未指明则存储1个字节。</li>
<li><code>VARBINARY</code>必须指明<code>M</code>，除了存储数据本身外，还需要1或2个字节来存储数据的字节数</li>
</ul>
<table>
<thead>
<tr>
<th><strong>二进制字符串类型</strong></th>
<th><strong>特点</strong></th>
<th><strong>值的长度</strong></th>
<th><strong>占用空间</strong></th>
</tr>
</thead>
<tbody><tr>
<td>BINARY(M)</td>
<td>固定长度</td>
<td>M （0 &lt;&#x3D; M &lt;&#x3D; 255）</td>
<td>M个字节</td>
</tr>
<tr>
<td>VARBINARY(M)</td>
<td>可变长度</td>
<td>M（0 &lt;&#x3D; M &lt;&#x3D; 65535）</td>
<td>M+1个字节</td>
</tr>
</tbody></table>
<pre class="line-numbers language-sql"><code class="language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> test_binary1<span class="token punctuation">(</span>
<span class="token number">f1</span> <span class="token keyword">BINARY</span><span class="token punctuation">,</span>
<span class="token number">f2</span> <span class="token keyword">BINARY</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token comment" spellcheck="true"># f3 VARBINARY,</span>
<span class="token number">f4</span> <span class="token keyword">VARBINARY</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> test_binary1<span class="token punctuation">(</span><span class="token number">f1</span><span class="token punctuation">,</span><span class="token number">f2</span><span class="token punctuation">)</span>
<span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">,</span><span class="token string">'a'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> test_binary1<span class="token punctuation">(</span><span class="token number">f1</span><span class="token punctuation">,</span><span class="token number">f2</span><span class="token punctuation">)</span>
<span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'尚'</span><span class="token punctuation">,</span><span class="token string">'尚'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">#失败</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> test_binary1<span class="token punctuation">(</span><span class="token number">f2</span><span class="token punctuation">,</span><span class="token number">f4</span><span class="token punctuation">)</span>
<span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'ab'</span><span class="token punctuation">,</span><span class="token string">'ab'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


mysql<span class="token operator">></span> <span class="token keyword">SELECT</span> LENGTH<span class="token punctuation">(</span><span class="token number">f2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>LENGTH<span class="token punctuation">(</span><span class="token number">f4</span><span class="token punctuation">)</span>
<span class="token operator">-</span><span class="token operator">></span> <span class="token keyword">FROM</span> test_binary1<span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">------------+------------+</span>
<span class="token operator">|</span> LENGTH<span class="token punctuation">(</span><span class="token number">f2</span><span class="token punctuation">)</span> <span class="token operator">|</span> LENGTH<span class="token punctuation">(</span><span class="token number">f4</span><span class="token punctuation">)</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">------------+------------+</span>
<span class="token operator">|</span> <span class="token number">3</span>                  <span class="token operator">|</span> <span class="token boolean">NULL</span>       <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">3</span>                  <span class="token operator">|</span> <span class="token number">2</span>          <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">------------+------------+</span>
<span class="token number">2</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>

<span class="token comment" spellcheck="true">## 23行的 3【f2 BINARY(3)】 和 2【f4 VARBINARY(10)】 是根据定义的长度指定的</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="BLOB类型"><a href="#BLOB类型" class="headerlink" title="BLOB类型"></a>BLOB类型</h4><p>是二进制大对象 ，容纳可变数量的数据。可以存储一个二进制的大对象，比如 <code>图片、音频和视频</code> 等 </p>
<p>实际工作中，往往不会在MySQL数据库中使用BLOB类型存储大对象数据，通常会将<code>图片、音频和视频文件</code>存储到 <code>服务器的磁盘上</code> ，并将图片、音频和视频的<strong>访问路径存储到MySQL中</strong> </p>
<table>
<thead>
<tr>
<th>二进制字符串类型</th>
<th>值的长度</th>
<th>长度范围</th>
<th>占用空间</th>
</tr>
</thead>
<tbody><tr>
<td>TINYBLOB</td>
<td>L</td>
<td>0 &lt;&#x3D; L &lt;&#x3D; 255</td>
<td>L + 1 个字节</td>
</tr>
<tr>
<td>BLOB</td>
<td>L</td>
<td>0 &lt;&#x3D; L &lt;&#x3D; 65535（相当于64KB）</td>
<td>L + 2 个字节</td>
</tr>
<tr>
<td>MEDIUMBLOB</td>
<td>L</td>
<td>0 &lt;&#x3D; L &lt;&#x3D; 16777215 （相当于16MB）</td>
<td>L + 3 个字节</td>
</tr>
<tr>
<td>LONGBLOB</td>
<td>L</td>
<td>0 &lt;&#x3D; L &lt;&#x3D; 4294967295（相当于4GB）</td>
<td>L + 4 个字节</td>
</tr>
</tbody></table>
<p> <strong>TEXT和BLOB的使用注意事项</strong><br> 在使用text和blob字段类型时要注意以下几点，以便更好的发挥数据库的性能。</p>
<p>① BLOB和TEXT值也会引起自己的一些问题，特别是执行了大量的删除或更新操作的时候。**删除这种值会在数据表中留下很大的” 空洞 “**，以后填入这些”空洞”的记录可能长度不同。为了提高性能，建议定期使用<code> OPTIMIZE TABLE</code> 功能对这类表进行 <code>碎片整理</code> 。</p>
<p>② 如果需要对大文本字段进行模糊查询，MySQL 提供了 <code>前缀索引</code> 。但是仍然要在不必要的时候<code>避免检索大型的BLOB或TEXT值</code>。例如，SELECT * 查询就不是很好的想法，除非你能够确定作为约束条件的WHERE子句只会找到所需要的数据行。否则，你可能毫无目的地在网络上传输大量的值。</p>
<p>③ 把BLOB或TEXT列 <code>分离到单独的表</code> 中。在某些环境中，如果把这些数据列移动到第二张数据表中，可以让你把原数据表中的数据列转换为固定长度的数据行格式，那么它就是有意义的。这会 <code>减少主表中的碎片</code> ，使你得到固定长度数据行的性能优势。它还使你在主数据表上运行 SELECT * 查询的时候不会通过网络传输大量的BLOB或TEXT值。 </p>
<h3 id="JSON类型"><a href="#JSON类型" class="headerlink" title="JSON类型"></a>JSON类型</h3><p>JSON（JavaScript Object Notation）是一种轻量级的 <code>数据交换格式</code> 。JSON 可以将 JavaScript 对象中表示的一组数据转换为字符串，然后就可以在网络或者程序之间轻松地传递这个字符串，并在需要的时候将它还原为各编程语言所支持的数据格式 </p>
<p>通过“-&gt;”和“-&gt;&gt;”符号，从JSON字段中正确查询出了指定的JSON数据的值 </p>
<pre class="line-numbers language-sql"><code class="language-sql"><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> test_json <span class="token punctuation">(</span>js<span class="token punctuation">)</span>
<span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">'{"name":"songhk", "age":18, "address":{"province":"beijing",
"city":"beijing"}}'</span><span class="token punctuation">)</span>

<span class="token keyword">SELECT</span> <span class="token operator">*</span>
<span class="token keyword">FROM</span> test_json

<span class="token keyword">SELECT</span> js <span class="token operator">-</span><span class="token operator">></span> <span class="token string">'$.name'</span> <span class="token keyword">AS</span> NAME<span class="token punctuation">,</span>js <span class="token operator">-</span><span class="token operator">></span> <span class="token string">'$.age'</span> <span class="token keyword">AS</span> age <span class="token punctuation">,</span>js <span class="token operator">-</span><span class="token operator">></span> <span class="token string">'$.address.province'</span>
<span class="token keyword">AS</span> province<span class="token punctuation">,</span> js <span class="token operator">-</span><span class="token operator">></span> <span class="token string">'$.address.city'</span> <span class="token keyword">AS</span> city
<span class="token keyword">FROM</span> test_json<span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="空间类型"><a href="#空间类型" class="headerlink" title="空间类型"></a>空间类型</h3><!--待补-->



<h2 id="参考文献-4"><a href="#参考文献-4" class="headerlink" title="参考文献"></a>参考文献</h2><p><a target="_blank" rel="noopener" href="https://www.yuque.com/attachments/yuque/0/2021/pdf/2040418/1637417355435-67ddc879-30fd-45e7-93de-3b7084f55b5a.pdf">📎第12章_MySQL数据类型精讲.pdf</a></p>
<h2 id="第13章：约束"><a href="#第13章：约束" class="headerlink" title="第13章：约束"></a>第13章：约束</h2><pre><code>constraint
</code></pre>
<p><strong>修改约束</strong></p>
<p>基本是 <code>alter table 表名称 modify 字段名 数据类型 约束类型</code></p>
<p>除了主键约束和外键约束是</p>
<p> <code>ALTER TABLE 表名称 ADD PRIMARY KEY(字段列表);</code></p>
<pre><code>ALTER TABLE 表名称 ADD [CONSTRAINT 约束名] FOREIGN KEY (从表的字段) REFERENCES 主表名
</code></pre>
<p><strong>删除约束</strong></p>
<p>基本是<code>alter table 表名称 modify 字段名 数据类型</code></p>
<p>主键、外键和唯一约束和其他有所区别</p>
<pre class="line-numbers language-sql"><code class="language-sql"><span class="token comment" spellcheck="true">-- 唯一约束需要找到相应索引</span>
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> 表名称 <span class="token keyword">DROP</span> <span class="token keyword">INDEX</span> 索引名

<span class="token comment" spellcheck="true">-- 删除主键约束，不需要指定主键名，因为一个表只有一个主键，删除主键约束后，非空还存在。</span>
<span class="token keyword">alter</span> <span class="token keyword">table</span> 表名称 <span class="token keyword">drop</span> <span class="token keyword">primary</span> <span class="token keyword">key</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">/* 删除外键 */</span>
<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>第一步先查看约束名和删除外键约束
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> information_schema<span class="token punctuation">.</span>table_constraints <span class="token keyword">WHERE</span> table_name <span class="token operator">=</span> <span class="token string">'表名称'</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">#查看某个</span>
表的约束名
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> 从表名 <span class="token keyword">DROP</span> <span class="token keyword">FOREIGN</span> <span class="token keyword">KEY</span> 外键约束名<span class="token punctuation">;</span>
（<span class="token number">2</span>）第二步查看索引名和删除索引。（注意，只能手动删除）
<span class="token keyword">SHOW</span> <span class="token keyword">INDEX</span> <span class="token keyword">FROM</span> 表名称<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">#查看某个表的索引名</span>
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> 从表名 <span class="token keyword">DROP</span> <span class="token keyword">INDEX</span> 索引名<span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="非空约束"><a href="#非空约束" class="headerlink" title="非空约束"></a>非空约束</h3><p><code>not null</code> 列不为空</p>
<pre class="line-numbers language-sql"><code class="language-sql"><span class="token comment" spellcheck="true">/*  创建非空约束 */</span>

<span class="token comment" spellcheck="true"># 创建表</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> 表名称<span class="token punctuation">(</span>
字段名 数据类型<span class="token punctuation">,</span>
字段名 数据类型 <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
字段名 数据类型 <span class="token operator">NOT</span> <span class="token boolean">NULL</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true"># 建表后</span>
<span class="token keyword">alter</span> <span class="token keyword">table</span> 表名称 <span class="token keyword">modify</span> 字段名 数据类型 <span class="token operator">not</span> <span class="token boolean">null</span>

<span class="token comment" spellcheck="true">/*  删除非空约束 */</span>
<span class="token keyword">alter</span> <span class="token keyword">table</span> 表名称 <span class="token keyword">modify</span> 字段名 数据类型 <span class="token boolean">NULL</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">#去掉not null，相当于修改某个非注解字段该字段允许为空</span>
或 
<span class="token keyword">alter</span> <span class="token keyword">table</span> 表名称 <span class="token keyword">modify</span> 字段名 数据类型<span class="token punctuation">;</span><span class="token comment" spellcheck="true">#去掉not null，相当于修改某个非注解字段，该字段允许为空</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="唯一约束"><a href="#唯一约束" class="headerlink" title="唯一约束"></a>唯一约束</h3><p><code>unique</code> 列的值唯一</p>
<pre class="line-numbers language-sql"><code class="language-sql"><span class="token comment" spellcheck="true">/* 创建唯一约束 */</span>

<span class="token keyword">create</span> <span class="token keyword">table</span> 表名称<span class="token punctuation">(</span>
字段名 数据类型<span class="token punctuation">,</span>
字段名 数据类型 <span class="token keyword">unique</span><span class="token punctuation">,</span>
字段名 数据类型 <span class="token keyword">unique</span> <span class="token keyword">key</span><span class="token punctuation">,</span>
字段名 数据类型
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">create</span> <span class="token keyword">table</span> 表名称<span class="token punctuation">(</span>
字段名 数据类型<span class="token punctuation">,</span>
字段名 数据类型<span class="token punctuation">,</span>
字段名 数据类型<span class="token punctuation">,</span>
<span class="token comment" spellcheck="true">-- 字段列表中写的是多个字段名，多个字段名用逗号分隔，表示那么是复合唯一，即多个字段的组合是唯一的</span>
<span class="token punctuation">[</span><span class="token keyword">constraint</span> 约束名<span class="token punctuation">]</span> <span class="token keyword">unique</span> <span class="token keyword">key</span><span class="token punctuation">(</span>字段名<span class="token punctuation">)</span> 
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">## 组合约束</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token keyword">USER</span><span class="token punctuation">(</span>
id <span class="token keyword">INT</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
NAME <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
PASSWORD <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token comment" spellcheck="true">-- 使用表级约束语法</span>
<span class="token keyword">CONSTRAINT</span> uk_name_pwd <span class="token keyword">UNIQUE</span><span class="token punctuation">(</span>NAME<span class="token punctuation">,</span>PASSWORD<span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true"># 修改约束</span>
<span class="token keyword">alter</span> <span class="token keyword">table</span> 表名称 <span class="token keyword">add</span> <span class="token keyword">unique</span> <span class="token keyword">key</span><span class="token punctuation">(</span>字段列表<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">alter</span> <span class="token keyword">table</span> 表名称 <span class="token keyword">modify</span> 字段名 字段类型 <span class="token keyword">unique</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">/* 删除约束  需要删除唯一索引*/</span>
<span class="token comment" spellcheck="true"># 1. 获取索引</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> information_schema<span class="token punctuation">.</span>table_constraints <span class="token keyword">WHERE</span> table_name <span class="token operator">=</span> <span class="token string">'表名'</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">#查看都有哪</span>
些约束
<span class="token keyword">show</span> <span class="token keyword">index</span> <span class="token keyword">from</span> 表名称<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">--查看表的索引</span>

<span class="token comment" spellcheck="true"># 2. 删除索引</span>
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> 表名称 <span class="token keyword">DROP</span> <span class="token keyword">INDEX</span> 索引名<span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="主键约束"><a href="#主键约束" class="headerlink" title="主键约束"></a>主键约束</h3><p><code>primary key</code> 相当于唯一约束+非空约束的组合。 </p>
<pre class="line-numbers language-sql"><code class="language-sql"><span class="token comment" spellcheck="true">/*  创建主键约束 */</span>

<span class="token keyword">create</span> <span class="token keyword">table</span> 表名称<span class="token punctuation">(</span>
字段名 数据类型 <span class="token keyword">primary</span> <span class="token keyword">key</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true">#列级模式</span>
字段名 数据类型<span class="token punctuation">,</span>
字段名 数据类型
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">create</span> <span class="token keyword">table</span> 表名称<span class="token punctuation">(</span>
字段名 数据类型<span class="token punctuation">,</span>
字段名 数据类型<span class="token punctuation">,</span>
字段名 数据类型<span class="token punctuation">,</span>
<span class="token punctuation">[</span><span class="token keyword">constraint</span> 约束名<span class="token punctuation">]</span> <span class="token keyword">primary</span> <span class="token keyword">key</span><span class="token punctuation">(</span>字段名<span class="token punctuation">)</span> <span class="token comment" spellcheck="true">#表级模式</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true"># 修改主键约束</span>
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> 表名称 <span class="token keyword">ADD</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">(</span>字段列表<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">#字段列表可以是一个字段，也可以是多个字段，如果是多</span>
个字段的话，是复合主键


<span class="token comment" spellcheck="true">/* 删除主键约束 */</span>
<span class="token comment" spellcheck="true">-- 删除主键约束，不需要指定主键名，因为一个表只有一个主键，删除主键约束后，非空还存在。</span>
<span class="token keyword">alter</span> <span class="token keyword">table</span> 表名称 <span class="token keyword">drop</span> <span class="token keyword">primary</span> <span class="token keyword">key</span><span class="token punctuation">;</span> 
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="外键约束"><a href="#外键约束" class="headerlink" title="外键约束"></a>外键约束</h3><p><strong>阿里开发规范</strong> </p>
<p>【 强制 】不得使用外键与级联，一切外键概念必须在应用层解决。<br>说明：（概念解释）学生表中的 student_id 是主键，那么成绩表中的 student_id 则为外键。如果更新学<br>生表中的 student_id，同时触发成绩表中的 student_id 更新，即为级联更新。外键与级联更新适用于 单<br>机低并发 ，不适合 分布式 、 高并发集群 ；级联更新是强阻塞，存在数据库 更新风暴 的风险；外键影响<br>数据库的 插入速度 。 </p>
<pre><code>foreign key
create table 主表名称(
字段1 数据类型 primary key,
字段2 数据类型
);
create table 从表名称(
字段1 数据类型 primary key,
字段2 数据类型,
[CONSTRAINT &lt;外键约束名称&gt;] FOREIGN KEY（从表的某个字段) references 主表名(被参考字段)
);
#(从表的某个字段)的数据类型必须与主表名(被参考字段)的数据类型一致，逻辑意义也一样
#(从表的某个字段)的字段名可以与主表名(被参考字段)的字段名一样，也可以不一样
-- FOREIGN KEY: 在表级指定子表中的列
-- REFERENCES: 标示在父表中的列

ALTER TABLE 从表名 ADD [CONSTRAINT 约束名] FOREIGN KEY (从表的字段) REFERENCES 主表名(被引用
字段) [on update xx][on delete xx];


/* 删除外键 */
(1)第一步先查看约束名和删除外键约束
SELECT * FROM information_schema.table_constraints WHERE table_name = &#39;表名称&#39;;#查看某个
表的约束名
ALTER TABLE 从表名 DROP FOREIGN KEY 外键约束名;
（2）第二步查看索引名和删除索引。（注意，只能手动删除）
SHOW INDEX FROM 表名称; #查看某个表的索引名
ALTER TABLE 从表名 DROP INDEX 索引名;
</code></pre>
<ul>
<li><p>添加了外键约束后，主表的修改和删除数据受约束</p>
</li>
<li><p>添加了外键约束后，从表的添加和修改数据受约束</p>
</li>
<li><p>在从表上建立外键，要求主表必须存在</p>
</li>
<li><p>删除主表时，要求从表从表先删除，或将从表中外键引用该主表的关系先删除</p>
</li>
</ul>
<h3 id="检查约束"><a href="#检查约束" class="headerlink" title="检查约束"></a>检查约束</h3><p><code>check</code> MySQL 8.0 有效</p>
<h3 id="默认值约束"><a href="#默认值约束" class="headerlink" title="默认值约束"></a>默认值约束</h3><pre><code>default
</code></pre>
<pre class="line-numbers language-sql"><code class="language-sql"><span class="token comment" spellcheck="true">/* 创建默认约束 */</span>

<span class="token keyword">create</span> <span class="token keyword">table</span> 表名称<span class="token punctuation">(</span>
字段名 数据类型 <span class="token keyword">primary</span> <span class="token keyword">key</span><span class="token punctuation">,</span>
字段名 数据类型 <span class="token keyword">unique</span> <span class="token keyword">key</span> <span class="token operator">not</span> <span class="token boolean">null</span><span class="token punctuation">,</span>
字段名 数据类型 <span class="token keyword">unique</span> <span class="token keyword">key</span><span class="token punctuation">,</span>
字段名 数据类型 <span class="token operator">not</span> <span class="token boolean">null</span> <span class="token keyword">default</span> 默认值<span class="token punctuation">,</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">create</span> <span class="token keyword">table</span> 表名称<span class="token punctuation">(</span>再举例：
字段名 数据类型 <span class="token keyword">default</span> 默认值 <span class="token punctuation">,</span>
字段名 数据类型 <span class="token operator">not</span> <span class="token boolean">null</span> <span class="token keyword">default</span> 默认值<span class="token punctuation">,</span>
字段名 数据类型 <span class="token operator">not</span> <span class="token boolean">null</span> <span class="token keyword">default</span> 默认值<span class="token punctuation">,</span>
<span class="token keyword">primary</span> <span class="token keyword">key</span><span class="token punctuation">(</span>字段名<span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token keyword">unique</span> <span class="token keyword">key</span><span class="token punctuation">(</span>字段名<span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
说明：默认值约束一般不在唯一键和主键列上加


<span class="token keyword">alter</span> <span class="token keyword">table</span> 表名称 <span class="token keyword">modify</span> 字段名 数据类型 <span class="token keyword">default</span> 默认值<span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">/* 删除默认约束 */</span>
<span class="token keyword">alter</span> <span class="token keyword">table</span> 表名称 <span class="token keyword">modify</span> 字段名 数据类型 <span class="token punctuation">;</span><span class="token comment" spellcheck="true">#删除默认值约束，也不保留非空约束</span>
<span class="token keyword">alter</span> <span class="token keyword">table</span> 表名称 <span class="token keyword">modify</span> 字段名 数据类型 <span class="token operator">not</span> <span class="token boolean">null</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">#删除默认值约束，保留非空约束</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="自增列"><a href="#自增列" class="headerlink" title="自增列"></a>自增列</h3><pre><code>auto_increment
</code></pre>
<p>只能在主键列和 唯一键列使用</p>
<pre class="line-numbers language-sql"><code class="language-sql"><span class="token comment" spellcheck="true">/* 创建自增约束 */</span>
<span class="token keyword">create</span> <span class="token keyword">table</span> 表名称<span class="token punctuation">(</span>
字段名 数据类型 <span class="token keyword">primary</span> <span class="token keyword">key</span> <span class="token keyword">auto_increment</span><span class="token punctuation">,</span>
字段名 数据类型 <span class="token keyword">unique</span> <span class="token keyword">key</span> <span class="token operator">not</span> <span class="token boolean">null</span><span class="token punctuation">,</span>
字段名 数据类型 <span class="token keyword">unique</span> <span class="token keyword">key</span><span class="token punctuation">,</span>
字段名 数据类型 <span class="token operator">not</span> <span class="token boolean">null</span> <span class="token keyword">default</span> 默认值<span class="token punctuation">,</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">create</span> <span class="token keyword">table</span> 表名称<span class="token punctuation">(</span>
字段名 数据类型 <span class="token keyword">default</span> 默认值 <span class="token punctuation">,</span>
字段名 数据类型 <span class="token keyword">unique</span> <span class="token keyword">key</span> <span class="token keyword">auto_increment</span><span class="token punctuation">,</span>
字段名 数据类型 <span class="token operator">not</span> <span class="token boolean">null</span> <span class="token keyword">default</span> 默认值<span class="token punctuation">,</span><span class="token punctuation">,</span>
<span class="token keyword">primary</span> <span class="token keyword">key</span><span class="token punctuation">(</span>字段名<span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">alter</span> <span class="token keyword">table</span> 表名称 <span class="token keyword">modify</span> 字段名 数据类型 <span class="token keyword">auto_increment</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">/* 删除自增约束 */</span>
<span class="token keyword">alter</span> <span class="token keyword">table</span> 表名称 <span class="token keyword">modify</span> 字段名 数据类型<span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-plain"><code class="language-plain">面试1、为什么建表时，加 not null default '' 或 default 0

答：不想让表中出现null值。

面试2、为什么不想要 null 的值

答:（1）不好比较。null是一种特殊值，比较时只能用专门的is null 和 is not null来比较。碰到运算符，通
常返回null。
（2）效率不高。影响提高索引效果。因此，我们往往在建表时 not null default '' 或 default 0

面试3、带AUTO_INCREMENT约束的字段值是从1开始的吗？ 

在MySQL中，默认AUTO_INCREMENT的初始
值是1，每新增一条记录，字段值自动加1。设置自增属性（AUTO_INCREMENT）的时候，还可以指定第
一条插入记录的自增字段的值，这样新插入的记录的自增字段值从初始值开始递增，如在表中插入第一
条记录，同时指定id值为5，则以后插入的记录的id值就会从6开始往上增加。添加主键约束时，往往需要
设置字段自动增加属性。



面试4、并不是每个表都可以任意选择存储引擎？ 外键约束（FOREIGN KEY）不能跨引擎使用。

MySQL支持多种存储引擎，每一个表都可以指定一个不同的存储引擎，需要注意的是：外键约束是用来
保证数据的参照完整性的，如果表之间需要关联外键，却指定了不同的存储引擎，那么这些表之间是不
能创建外键约束的。所以说，存储引擎的选择也不完全是随意的。
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h1 id="其它数据库对象篇"><a href="#其它数据库对象篇" class="headerlink" title="其它数据库对象篇"></a>其它数据库对象篇</h1><h2 id="第14章：视图"><a href="#第14章：视图" class="headerlink" title="第14章：视图"></a>第14章：视图</h2><h3 id="视图的理解"><a href="#视图的理解" class="headerlink" title="视图的理解"></a>视图的理解</h3><ul>
<li><p>虚拟表，不存储数据。<code>本质是：存储的select语句</code></p>
</li>
<li><p>DML操作，会影响基表的数据。</p>
</li>
<li><p>视图的删除，不会导致基表数据删除</p>
</li>
<li><p>应用场景：针对大型项目</p>
</li>
<li><p>优点：简化查询；控制数据访问。</p>
</li>
</ul>
<h3 id="创建视图"><a href="#创建视图" class="headerlink" title="创建视图"></a>创建视图</h3><pre class="line-numbers language-sql"><code class="language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">VIEW</span> 视图名称
<span class="token keyword">AS</span> 查询语句
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h4 id="单表视图"><a href="#单表视图" class="headerlink" title="单表视图"></a>单表视图</h4><h4 id="多表视图"><a href="#多表视图" class="headerlink" title="多表视图"></a>多表视图</h4><h4 id="基于视图创建视图"><a href="#基于视图创建视图" class="headerlink" title="基于视图创建视图"></a>基于视图创建视图</h4><h3 id="查看视图"><a href="#查看视图" class="headerlink" title="查看视图"></a>查看视图</h3><pre class="line-numbers language-sql"><code class="language-sql"><span class="token comment" spellcheck="true"># 语法1：查看数据库的表对象、视图对象</span>
<span class="token keyword">SHOW</span> <span class="token keyword">TABLES</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">#语法2：查看视图的结构</span>
<span class="token keyword">DESC</span> <span class="token operator">/</span> <span class="token keyword">DESCRIBE</span> 视图名称<span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">#语法3：查看视图的属性信息</span>
<span class="token keyword">SHOW</span> <span class="token keyword">TABLE</span> <span class="token keyword">STATUS</span> <span class="token operator">LIKE</span> <span class="token string">'视图名称'</span>\G

<span class="token comment" spellcheck="true">#语法4：查看视图的详细定义信息</span>
<span class="token keyword">SHOW</span> <span class="token keyword">CREATE</span> <span class="token keyword">VIEW</span> 视图名称<span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="更新视图数据"><a href="#更新视图数据" class="headerlink" title="更新视图数据"></a>更新视图数据</h3><p>当视图中的数据发生变化时，数据表中的数据也会发生变化，反之亦然 </p>
<h4 id="一般情况"><a href="#一般情况" class="headerlink" title="一般情况"></a>一般情况</h4><p>字段一致时可以修改</p>
<h4 id="不可更新的视图"><a href="#不可更新的视图" class="headerlink" title="不可更新的视图"></a>不可更新的视图</h4><p><img src="https://cdn.nlark.com/yuque/0/2021/png/2040418/1637478805430-45ca3a9f-6341-4a03-b984-09bfa3802a09.png" alt="img"></p>
<h3 id="修改、删除视图"><a href="#修改、删除视图" class="headerlink" title="修改、删除视图"></a>修改、删除视图</h3><h4 id="修改视图"><a href="#修改视图" class="headerlink" title="修改视图"></a>修改视图</h4><pre class="line-numbers language-sql"><code class="language-sql"><span class="token comment" spellcheck="true"># 方式1：使用CREATE OR REPLACE VIEW 子句修改视图</span>
<span class="token keyword">CREATE</span> <span class="token operator">OR</span> REPLACE <span class="token keyword">VIEW</span> empvu80
<span class="token punctuation">(</span>id_number<span class="token punctuation">,</span> name<span class="token punctuation">,</span> sal<span class="token punctuation">,</span> department_id<span class="token punctuation">)</span>
<span class="token keyword">AS</span>
<span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span> first_name <span class="token operator">||</span> <span class="token string">' '</span> <span class="token operator">||</span> last_name<span class="token punctuation">,</span> salary<span class="token punctuation">,</span> department_id
<span class="token keyword">FROM</span> employees
<span class="token keyword">WHERE</span> department_id <span class="token operator">=</span> <span class="token number">80</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true"># 方式二</span>
<span class="token keyword">ALTER</span> <span class="token keyword">VIEW</span> 视图名称
<span class="token keyword">AS</span>
查询语句
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="删除视图"><a href="#删除视图" class="headerlink" title="删除视图"></a>删除视图</h4><p>与删除表类似</p>
<pre class="line-numbers language-sql"><code class="language-sql"><span class="token keyword">DROP</span> <span class="token keyword">VIEW</span> <span class="token keyword">IF</span> <span class="token keyword">EXISTS</span> 视图名称<span class="token punctuation">;</span>

<span class="token keyword">DROP</span> <span class="token keyword">VIEW</span> <span class="token keyword">IF</span> <span class="token keyword">EXISTS</span> 视图名称<span class="token number">1</span><span class="token punctuation">,</span>视图名称<span class="token number">2</span><span class="token punctuation">,</span>视图名称<span class="token number">3</span><span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<h2 id="第15章：存储过程与函数"><a href="#第15章：存储过程与函数" class="headerlink" title="第15章：存储过程与函数"></a>第15章：存储过程与函数</h2><p><code>Stored Procedure</code> 一组经过 预先编译 的 SQL 语句的封装。 </p>
<p>存储函数可以放在查询语句中使用，存储过程不行。</p>
<p>存储过程的功能更加强大，包括能够执行对表的操作（比如创建表 ，删除表等）和事务操作，这些功能是存储函数不具备的 .</p>
<table>
<thead>
<tr>
<th></th>
<th><strong>关键字</strong></th>
<th><strong>调用语法</strong></th>
<th><strong>返回值</strong></th>
<th><strong>应用场景</strong></th>
</tr>
</thead>
<tbody><tr>
<td>存储过 程</td>
<td>PROCEDURE</td>
<td>CALL 存储过 程()</td>
<td>理解为有0个或 多个</td>
<td>一般用于更新</td>
</tr>
<tr>
<td>存储函 数</td>
<td>FUNCTION</td>
<td>SELECT 函数 ()</td>
<td>只能是一个</td>
<td>一般用于查询结果为一个值并 返回时</td>
</tr>
</tbody></table>
<h3 id="创建存储过程"><a href="#创建存储过程" class="headerlink" title="创建存储过程"></a>创建存储过程</h3><pre class="line-numbers language-sql"><code class="language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">PROCEDURE</span> 存储过程名<span class="token punctuation">(</span><span class="token operator">IN</span><span class="token operator">|</span><span class="token keyword">OUT</span><span class="token operator">|</span><span class="token keyword">INOUT</span> 参数名 参数类型<span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span>
<span class="token punctuation">[</span>characteristics <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span>
<span class="token keyword">BEGIN</span>
存储过程体
<span class="token keyword">END</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="无参无返回值"><a href="#无参无返回值" class="headerlink" title="无参无返回值"></a>无参无返回值</h4><pre class="line-numbers language-sql"><code class="language-sql"><span class="token comment" spellcheck="true">#举例1：创建存储过程select_all_data()，查看 employees 表的所有数据</span>
<span class="token keyword">DELIMITER</span> $
<span class="token keyword">CREATE</span> <span class="token keyword">PROCEDURE</span> select_all_data<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">BEGIN</span>
    <span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> employees<span class="token punctuation">;</span>
<span class="token keyword">END</span> $
<span class="token keyword">DELIMITER</span> <span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">#2. 存储过程的调用</span>
<span class="token keyword">CALL</span> select_all_data<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token comment" spellcheck="true">#举例2：创建存储过程avg_employee_salary()，返回所有员工的平均工资</span>

<span class="token keyword">DELIMITER</span> <span class="token comment" spellcheck="true">//</span>
<span class="token keyword">CREATE</span> <span class="token keyword">PROCEDURE</span> avg_employee_salary<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">BEGIN</span> 
    <span class="token keyword">SELECT</span> <span class="token function">AVG</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> <span class="token keyword">FROM</span> employees<span class="token punctuation">;</span>

<span class="token keyword">END</span> <span class="token comment" spellcheck="true">//</span>
<span class="token keyword">DELIMITER</span> <span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">#调用</span>
<span class="token keyword">CALL</span> avg_employee_salary<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="带out"><a href="#带out" class="headerlink" title="带out"></a>带out</h4><p>查询结果字段需要<code>into``OUT</code>的字段</p>
<pre class="line-numbers language-sql"><code class="language-sql"><span class="token comment" spellcheck="true">#类型2：带 OUT</span>
<span class="token comment" spellcheck="true">#举例4：创建存储过程show_min_salary()，查看“emps”表的最低薪资值。并将最低薪资</span>
<span class="token comment" spellcheck="true">#通过OUT参数“ms”输出</span>

<span class="token keyword">DESC</span> employees<span class="token punctuation">;</span>

<span class="token keyword">DELIMITER</span> <span class="token comment" spellcheck="true">//</span>

<span class="token keyword">CREATE</span> <span class="token keyword">PROCEDURE</span> show_min_salary<span class="token punctuation">(</span><span class="token keyword">OUT</span> ms <span class="token keyword">DOUBLE</span><span class="token punctuation">)</span>
<span class="token keyword">BEGIN</span>
    <span class="token keyword">SELECT</span> <span class="token function">MIN</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> <span class="token keyword">INTO</span> ms
    <span class="token keyword">FROM</span> employees<span class="token punctuation">;</span>
<span class="token keyword">END</span> <span class="token comment" spellcheck="true">//</span>

<span class="token keyword">DELIMITER</span> <span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">#调用</span>

<span class="token keyword">CALL</span> show_min_salary<span class="token punctuation">(</span><span class="token variable">@ms</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">#查看变量值</span>
<span class="token keyword">SELECT</span> <span class="token variable">@ms</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="带in"><a href="#带in" class="headerlink" title="带in"></a>带in</h4><p>给参数直接给参数。或者声明变量给参数</p>
<pre class="line-numbers language-sql"><code class="language-sql"><span class="token comment" spellcheck="true">#类型3：带 IN</span>
<span class="token comment" spellcheck="true">#举例5：创建存储过程show_someone_salary()，查看“emps”表的某个员工的薪资，</span>
<span class="token comment" spellcheck="true">#并用IN参数empname输入员工姓名。</span>

<span class="token keyword">DELIMITER</span> <span class="token comment" spellcheck="true">//</span>

<span class="token keyword">CREATE</span> <span class="token keyword">PROCEDURE</span> show_someone_salary<span class="token punctuation">(</span><span class="token operator">IN</span> empname <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">BEGIN</span>
    <span class="token keyword">SELECT</span> salary <span class="token keyword">FROM</span> employees
    <span class="token keyword">WHERE</span> last_name <span class="token operator">=</span> empname<span class="token punctuation">;</span>
<span class="token keyword">END</span> <span class="token comment" spellcheck="true">//</span>

<span class="token keyword">DELIMITER</span> <span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">#调用方式1</span>
<span class="token keyword">CALL</span> show_someone_salary<span class="token punctuation">(</span><span class="token string">'Abel'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">#调用方式2</span>
<span class="token keyword">SET</span> <span class="token variable">@empname</span> :<span class="token operator">=</span> <span class="token string">'Abel'</span><span class="token punctuation">;</span>
<span class="token keyword">CALL</span> show_someone_salary<span class="token punctuation">(</span><span class="token variable">@empname</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="带in、out"><a href="#带in、out" class="headerlink" title="带in、out"></a>带in、out</h4><pre class="line-numbers language-sql"><code class="language-sql"><span class="token comment" spellcheck="true">#类型4：带 IN 和 OUT</span>
<span class="token comment" spellcheck="true">#举例6：创建存储过程show_someone_salary2()，查看“emps”表的某个员工的薪资，</span>
<span class="token comment" spellcheck="true">#并用IN参数empname输入员工姓名，用OUT参数empsalary输出员工薪资。</span>

<span class="token keyword">DELIMITER</span> <span class="token comment" spellcheck="true">//</span>

<span class="token keyword">CREATE</span> <span class="token keyword">PROCEDURE</span> show_someone_salary2<span class="token punctuation">(</span><span class="token operator">IN</span> empname <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token keyword">OUT</span> empsalary <span class="token keyword">DECIMAL</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">BEGIN</span>
    <span class="token keyword">SELECT</span> salary <span class="token keyword">INTO</span> empsalary
    <span class="token keyword">FROM</span> employees
    <span class="token keyword">WHERE</span> last_name <span class="token operator">=</span> empname<span class="token punctuation">;</span>
<span class="token keyword">END</span> <span class="token comment" spellcheck="true">//</span>

<span class="token keyword">DELIMITER</span> <span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">#调用</span>
<span class="token keyword">SET</span> <span class="token variable">@empname</span> <span class="token operator">=</span> <span class="token string">'Abel'</span><span class="token punctuation">;</span>
<span class="token keyword">CALL</span> show_someone_salary2<span class="token punctuation">(</span><span class="token variable">@empname</span><span class="token punctuation">,</span><span class="token variable">@empsalary</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">SELECT</span> <span class="token variable">@empsalary</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="带inout"><a href="#带inout" class="headerlink" title="带inout"></a>带inout</h4><p>既当输入值又当输出值。</p>
<pre class="line-numbers language-sql"><code class="language-sql"><span class="token comment" spellcheck="true">#类型5：带 INOUT</span>
<span class="token comment" spellcheck="true">#举例7：创建存储过程show_mgr_name()，查询某个员工领导的姓名，并用INOUT参数“empname”输入员工姓名，</span>
<span class="token comment" spellcheck="true">#输出领导的姓名。</span>

<span class="token keyword">DESC</span> employees<span class="token punctuation">;</span>

<span class="token keyword">DELIMITER</span> $

<span class="token keyword">CREATE</span> <span class="token keyword">PROCEDURE</span> show_mgr_name<span class="token punctuation">(</span><span class="token keyword">INOUT</span> empname <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">BEGIN</span>

    <span class="token keyword">SELECT</span> last_name <span class="token keyword">INTO</span> empname
    <span class="token keyword">FROM</span> employees
    <span class="token keyword">WHERE</span> employee_id <span class="token operator">=</span> <span class="token punctuation">(</span>
                <span class="token keyword">SELECT</span> manager_id
                <span class="token keyword">FROM</span> employees
                <span class="token keyword">WHERE</span> last_name <span class="token operator">=</span> empname
                <span class="token punctuation">)</span><span class="token punctuation">;</span>
    
<span class="token keyword">END</span> $

<span class="token keyword">DELIMITER</span> <span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">#调用</span>
<span class="token keyword">SET</span> <span class="token variable">@empname</span> :<span class="token operator">=</span> <span class="token string">'Abel'</span><span class="token punctuation">;</span>
<span class="token keyword">CALL</span> show_mgr_name<span class="token punctuation">(</span><span class="token variable">@empname</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">SELECT</span> <span class="token variable">@empname</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="存储函数"><a href="#存储函数" class="headerlink" title="存储函数"></a>存储函数</h3><pre class="line-numbers language-sql"><code class="language-sql"><span class="token comment" spellcheck="true"># 声明存储函数</span>
<span class="token keyword">CREATE</span> <span class="token keyword">FUNCTION</span> 函数名<span class="token punctuation">(</span>参数名 参数类型<span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span>
<span class="token keyword">RETURNS</span> 返回值类型
<span class="token punctuation">[</span>characteristics <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span>
<span class="token keyword">BEGIN</span>
函数体 <span class="token comment" spellcheck="true">#函数体中肯定有 RETURN 语句</span>
<span class="token keyword">END</span>


<span class="token comment" spellcheck="true"># 调用</span>
<span class="token keyword">SELECT</span> 函数名<span class="token punctuation">(</span>实参列表<span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="空参"><a href="#空参" class="headerlink" title="空参"></a>空参</h4><pre class="line-numbers language-sql"><code class="language-sql"><span class="token comment" spellcheck="true"># 举例1：创建存储函数，名称为email_by_name()，参数定义为空，</span>
<span class="token comment" spellcheck="true">#该函数查询Abel的email，并返回，数据类型为字符串型。</span>

<span class="token keyword">DELIMITER</span> <span class="token comment" spellcheck="true">//</span>

<span class="token keyword">CREATE</span> <span class="token keyword">FUNCTION</span> email_by_name<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">RETURNS</span> <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">25</span><span class="token punctuation">)</span>
    <span class="token keyword">DETERMINISTIC</span>
    <span class="token keyword">CONTAINS</span> SQL
    <span class="token keyword">READS SQL DATA</span>
<span class="token keyword">BEGIN</span>
    <span class="token keyword">RETURN</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> email <span class="token keyword">FROM</span> employees <span class="token keyword">WHERE</span> last_name <span class="token operator">=</span> <span class="token string">'Abel'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">END</span> <span class="token comment" spellcheck="true">//</span>

<span class="token keyword">DELIMITER</span> <span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">#调用</span>
<span class="token keyword">SELECT</span> email_by_name<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">SELECT</span> email<span class="token punctuation">,</span>last_name <span class="token keyword">FROM</span> employees <span class="token keyword">WHERE</span> last_name <span class="token operator">=</span> <span class="token string">'Abel'</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="有参"><a href="#有参" class="headerlink" title="有参"></a>有参</h4><pre class="line-numbers language-sql"><code class="language-sql"><span class="token comment" spellcheck="true">#举例2：创建存储函数，名称为email_by_id()，参数传入emp_id，该函数查询emp_id的email，</span>
<span class="token comment" spellcheck="true">#并返回，数据类型为字符串型。</span>

<span class="token comment" spellcheck="true">#创建函数前执行此语句，保证函数的创建会成功</span>
<span class="token keyword">SET</span> <span class="token keyword">GLOBAL</span> log_bin_trust_function_creators <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">#声明函数</span>

<span class="token keyword">DELIMITER</span> <span class="token comment" spellcheck="true">//</span>

<span class="token keyword">CREATE</span> <span class="token keyword">FUNCTION</span> email_by_id<span class="token punctuation">(</span>emp_id <span class="token keyword">INT</span><span class="token punctuation">)</span>
<span class="token keyword">RETURNS</span> <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">25</span><span class="token punctuation">)</span>

<span class="token keyword">BEGIN</span>
    <span class="token keyword">RETURN</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> email <span class="token keyword">FROM</span> employees <span class="token keyword">WHERE</span> employee_id <span class="token operator">=</span> emp_id<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">END</span> <span class="token comment" spellcheck="true">//</span>

<span class="token keyword">DELIMITER</span> <span class="token punctuation">;</span>


<span class="token comment" spellcheck="true">#调用</span>
<span class="token keyword">SELECT</span> email_by_id<span class="token punctuation">(</span><span class="token number">101</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">SET</span> <span class="token variable">@emp_id</span> :<span class="token operator">=</span> <span class="token number">102</span><span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> email_by_id<span class="token punctuation">(</span><span class="token variable">@emp_id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="存储过程和存储函数的查询、修改删除"><a href="#存储过程和存储函数的查询、修改删除" class="headerlink" title="存储过程和存储函数的查询、修改删除"></a>存储过程和存储函数的查询、修改删除</h3><h4 id="查看"><a href="#查看" class="headerlink" title="查看"></a>查看</h4><ul>
<li><strong>方式1. 使用SHOW CREATE语句查看存储过程和函数的创建信息</strong></li>
</ul>
<pre class="line-numbers language-sql"><code class="language-sql"><span class="token comment" spellcheck="true">#方式1. 使用SHOW CREATE语句查看存储过程和函数的创建信息</span>
<span class="token keyword">SHOW</span> <span class="token keyword">CREATE</span> {<span class="token keyword">PROCEDURE</span> <span class="token operator">|</span> <span class="token keyword">FUNCTION</span>} 存储过程名或函数名

<span class="token comment" spellcheck="true">#eg：</span>
<span class="token keyword">SHOW</span> <span class="token keyword">CREATE</span> <span class="token keyword">PROCEDURE</span> show_mgr_name<span class="token punctuation">;</span>
<span class="token keyword">SHOW</span> <span class="token keyword">CREATE</span> <span class="token keyword">FUNCTION</span> count_by_id<span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ul>
<li><strong>方式2. 使用SHOW STATUS语句查看存储过程和函数的状态信息</strong></li>
</ul>
<pre class="line-numbers language-sql"><code class="language-sql"><span class="token comment" spellcheck="true">#方式2. 使用SHOW STATUS语句查看存储过程和函数的状态信息</span>
<span class="token keyword">SHOW</span> {<span class="token keyword">PROCEDURE</span> <span class="token operator">|</span> <span class="token keyword">FUNCTION</span>} <span class="token keyword">STATUS</span> <span class="token punctuation">[</span><span class="token operator">LIKE</span> <span class="token string">'pattern'</span><span class="token punctuation">]</span>

<span class="token comment" spellcheck="true">#eg:</span>
<span class="token keyword">SHOW</span> <span class="token keyword">PROCEDURE</span> <span class="token keyword">STATUS</span><span class="token punctuation">;</span>
<span class="token keyword">SHOW</span> <span class="token keyword">PROCEDURE</span> <span class="token keyword">STATUS</span> <span class="token operator">LIKE</span> <span class="token string">'show_max_salary'</span><span class="token punctuation">;</span>
<span class="token keyword">SHOW</span> <span class="token keyword">FUNCTION</span> <span class="token keyword">STATUS</span> <span class="token operator">LIKE</span> <span class="token string">'email_by_id'</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ul>
<li><strong>方式3 从information_schema.Routines表中查看存储过程和函数的信息</strong></li>
</ul>
<pre class="line-numbers language-sql"><code class="language-sql"><span class="token comment" spellcheck="true">#方式3.从information_schema.Routines表中查看存储过程和函数的信息</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> information_schema<span class="token punctuation">.</span>Routines
<span class="token keyword">WHERE</span> ROUTINE_NAME<span class="token operator">=</span><span class="token string">'存储过程或函数的名'</span> <span class="token punctuation">[</span><span class="token operator">AND</span> ROUTINE_TYPE <span class="token operator">=</span> {<span class="token string">'PROCEDURE|FUNCTION'</span>}<span class="token punctuation">]</span>

<span class="token comment" spellcheck="true">#eg:</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> information_schema<span class="token punctuation">.</span>Routines
<span class="token keyword">WHERE</span> ROUTINE_NAME<span class="token operator">=</span><span class="token string">'email_by_id'</span> <span class="token operator">AND</span> ROUTINE_TYPE <span class="token operator">=</span> <span class="token string">'FUNCTION'</span><span class="token punctuation">;</span>

<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> information_schema<span class="token punctuation">.</span>Routines
<span class="token keyword">WHERE</span> ROUTINE_NAME<span class="token operator">=</span><span class="token string">'show_min_salary'</span> <span class="token operator">AND</span> ROUTINE_TYPE <span class="token operator">=</span> <span class="token string">'PROCEDURE'</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="修改"><a href="#修改" class="headerlink" title="修改"></a>修改</h4><pre class="line-numbers language-sql"><code class="language-sql"><span class="token keyword">ALTER</span> {<span class="token keyword">PROCEDURE</span> <span class="token operator">|</span> <span class="token keyword">FUNCTION</span>} 存储过程或函数的名 <span class="token punctuation">[</span>characteristic <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://cdn.nlark.com/yuque/0/2021/png/2040418/1637483232297-bdd17f49-8a26-4b30-b3f7-2c4ecef73fce.png" alt="img"></p>
<h4 id="删除"><a href="#删除" class="headerlink" title="删除"></a>删除</h4><pre class="line-numbers language-sql"><code class="language-sql"><span class="token keyword">DROP</span> {<span class="token keyword">PROCEDURE</span> <span class="token operator">|</span> <span class="token keyword">FUNCTION</span>} <span class="token punctuation">[</span><span class="token keyword">IF</span> <span class="token keyword">EXISTS</span><span class="token punctuation">]</span> 存储过程或函数的名
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h2 id="参考文献-5"><a href="#参考文献-5" class="headerlink" title="参考文献"></a>参考文献</h2><p><a target="_blank" rel="noopener" href="https://www.yuque.com/attachments/yuque/0/2021/pdf/2040418/1637483537904-c1cf3361-7dac-4d39-9f76-ad4f6b472180.pdf">📎第15章_存储过程与函数.pdf</a></p>
<h2 id="第16章：变量、流程控制与游标【待完善】"><a href="#第16章：变量、流程控制与游标【待完善】" class="headerlink" title="第16章：变量、流程控制与游标【待完善】"></a>第16章：变量、流程控制与游标【待完善】</h2><p><a target="_blank" rel="noopener" href="https://www.yuque.com/attachments/yuque/0/2021/pdf/2040418/1637484004800-f7e3c2ef-e968-41c0-b094-2925e3ab4d8c.pdf">📎第16章_变量、流程控制与游标.pdf</a></p>
<h2 id="第17章：触发器【待完善】"><a href="#第17章：触发器【待完善】" class="headerlink" title="第17章：触发器【待完善】"></a>第17章：触发器【待完善】</h2><p><a target="_blank" rel="noopener" href="https://www.yuque.com/attachments/yuque/0/2021/pdf/2040418/1637484021933-9291ba6d-2ae8-44c5-ae67-2d047de8cefd.pdf">📎第17章_触发器.pdf</a></p>
<h1 id="事务【待完善】"><a href="#事务【待完善】" class="headerlink" title="事务【待完善】"></a>事务【待完善】</h1><h1 id="权限【待完善】"><a href="#权限【待完善】" class="headerlink" title="权限【待完善】"></a>权限【待完善】</h1><h1 id="维护【待完善】"><a href="#维护【待完善】" class="headerlink" title="维护【待完善】"></a>维护【待完善】</h1><h1 id="MySQL8-新特性篇【待完善】"><a href="#MySQL8-新特性篇【待完善】" class="headerlink" title="MySQL8 新特性篇【待完善】"></a>MySQL8 新特性篇【待完善】</h1><h2 id="第18章：MySQL8其它新特性【待完善】"><a href="#第18章：MySQL8其它新特性【待完善】" class="headerlink" title="第18章：MySQL8其它新特性【待完善】"></a>第18章：MySQL8其它新特性【待完善】</h2><p><a target="_blank" rel="noopener" href="https://www.yuque.com/attachments/yuque/0/2021/pdf/2040418/1637478174567-41489bbb-67f5-413c-ade8-0a74b3db8d47.pdf">📎第18章_MySQL8其它新特性.pdf</a></p>
<h1 id="-1"><a href="#-1" class="headerlink" title=""></a></h1><h1 id="MySQL进阶【2022-1】"><a href="#MySQL进阶【2022-1】" class="headerlink" title="MySQL进阶【2022-1】"></a>MySQL进阶【2022-1】</h1>
                
            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        文章作者:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="/about" rel="external nofollow noreferrer">Alexandermucc</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        文章链接:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="https://alexandermucc.github.io/2022/03/28/tech-mysql/">https://alexandermucc.github.io/2022/03/28/tech-mysql/</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        版权声明:
                    </i>
                </span>
                <span class="reprint-info">
                    本博客所有文章除特別声明外，均采用
                    <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>
                    许可协议。转载请注明来源
                    <a href="/about" target="_blank">Alexandermucc</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>复制成功，请遵循本文的转载规则</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">查看</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            
                                <a href="/tags/MySQL/">
                                    <span class="chip bg-color">MySQL</span>
                                </a>
                            
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">
<div id="article-share">

    
    <div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div>
    <script src="/libs/share/js/social-share.min.js"></script>
    

    

</div>

                </div>
            </div>
            
                <style>
    #reward {
        margin: 40px 0;
        text-align: center;
    }

    #reward .reward-link {
        font-size: 1.4rem;
        line-height: 38px;
    }

    #reward .btn-floating:hover {
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2), 0 5px 15px rgba(0, 0, 0, 0.2);
    }

    #rewardModal {
        width: 320px;
        height: 350px;
    }

    #rewardModal .reward-title {
        margin: 15px auto;
        padding-bottom: 5px;
    }

    #rewardModal .modal-content {
        padding: 10px;
    }

    #rewardModal .close {
        position: absolute;
        right: 15px;
        top: 15px;
        color: rgba(0, 0, 0, 0.5);
        font-size: 1.3rem;
        line-height: 20px;
        cursor: pointer;
    }

    #rewardModal .close:hover {
        color: #ef5350;
        transform: scale(1.3);
        -moz-transform:scale(1.3);
        -webkit-transform:scale(1.3);
        -o-transform:scale(1.3);
    }

    #rewardModal .reward-tabs {
        margin: 0 auto;
        width: 210px;
    }

    .reward-tabs .tabs {
        height: 38px;
        margin: 10px auto;
        padding-left: 0;
    }

    .reward-content ul {
        padding-left: 0 !important;
    }

    .reward-tabs .tabs .tab {
        height: 38px;
        line-height: 38px;
    }

    .reward-tabs .tab a {
        color: #fff;
        background-color: #ccc;
    }

    .reward-tabs .tab a:hover {
        background-color: #ccc;
        color: #fff;
    }

    .reward-tabs .wechat-tab .active {
        color: #fff !important;
        background-color: #22AB38 !important;
    }

    .reward-tabs .alipay-tab .active {
        color: #fff !important;
        background-color: #019FE8 !important;
    }

    .reward-tabs .reward-img {
        width: 210px;
        height: 210px;
    }
</style>

<div id="reward">
    <a href="#rewardModal" class="reward-link modal-trigger btn-floating btn-medium waves-effect waves-light red">赏</a>

    <!-- Modal Structure -->
    <div id="rewardModal" class="modal">
        <div class="modal-content">
            <a class="close modal-close"><i class="fas fa-times"></i></a>
            <h4 class="reward-title">你的赏识是我前进的动力</h4>
            <div class="reward-content">
                <div class="reward-tabs">
                    <ul class="tabs row">
                        <li class="tab col s6 alipay-tab waves-effect waves-light"><a href="#alipay">支付宝</a></li>
                        <li class="tab col s6 wechat-tab waves-effect waves-light"><a href="#wechat">微 信</a></li>
                    </ul>
                    <div id="alipay">
                        <img src="/medias/reward/alipay.jpg" class="reward-img" alt="支付宝打赏二维码">
                    </div>
                    <div id="wechat">
                        <img src="/medias/reward/wechat.png" class="reward-img" alt="微信打赏二维码">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(function () {
        $('.tabs').tabs();
    });
</script>

            
        </div>
    </div>

    

    

    

    

    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fas fa-chevron-left"></i>&nbsp;上一篇</div>
            <div class="card">
                <a href="/2022/03/29/tech-java-ji-chu-ji-cheng/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/22.jpg" class="responsive-img" alt="tech-Java基础-继承">
                        
                        <span class="card-title">tech-Java基础-继承</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="far fa-clock fa-fw icon-date"></i>2022-03-29
                        </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/technique/" class="post-category">
                                    technique
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/Java%E5%9F%BA%E7%A1%80/">
                        <span class="chip bg-color">Java基础</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                下一篇&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/2022/03/23/ds-zi-fu-chuan-017-han-you-suo-you-zi-fu-de-zui-duan-zi-fu-chuan/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/4.jpg" class="responsive-img" alt="DS-字符串017-含有所有字符的最短字符串">
                        
                        <span class="card-title">DS-字符串017-含有所有字符的最短字符串</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2022-03-23
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/LeetCode/" class="post-category">
                                    LeetCode
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/%E5%AD%97%E7%AC%A6%E4%B8%B2/">
                        <span class="chip bg-color">字符串</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>



<!-- 代码块功能依赖 -->
<!-- <script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script> -->

<!-- 代码语言 -->
<!--  -->
<!-- <script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script> -->
<!--  -->

<!-- 代码块复制 -->
<!--  -->
<!-- <script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script> -->
<!--  -->

<!-- 代码块收缩 -->
<!--  -->
<!-- <script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script> -->
<!--  -->

<!-- 代码块功能依赖 -->
<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>

<!-- 代码语言 -->

<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>


<!-- 代码块复制 -->

<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>


<!-- 代码块收缩 -->

<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script>


<!-- 代码块折行 -->

<style type="text/css">
code[class*="language-"], pre[class*="language-"] { white-space: pre !important; }
</style>



    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget card" style="background-color: white;">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;目录</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('0'),
            headingSelector: 'h2, h3, h4'
        });

        // modify the toc link href to support Chinese.
        let i = 0;
        let tocHeading = 'toc-heading-';
        $('#toc-content a').each(function () {
            $(this).attr('href', '#' + tocHeading + (++i));
        });

        // modify the heading title id to support Chinese.
        i = 0;
        $('#articleContent').children('h2, h3, h4').each(function () {
            $(this).attr('id', tocHeading + (++i));
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>




    <footer class="page-footer bg-color">
    

    <div class="container row center-align"
         style="margin-bottom: 0px !important;">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            
                <span id="year">2022</span>
            
            <a href="/about" target="_blank">Alexandermucc</a>
            |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
            |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a>
            <br>
            
                &nbsp;<i class="fas fa-chart-area"></i>&nbsp;站点总字数:&nbsp;<span
                        class="white-color">40.7k</span>
            
            
            
                
            
            
                <span id="busuanzi_container_site_pv">
                &nbsp;|&nbsp;<i class="far fa-eye"></i>&nbsp;总访问量:&nbsp;
                    <span id="busuanzi_value_site_pv" class="white-color"></span>
            </span>
            
            
                <span id="busuanzi_container_site_uv">
                &nbsp;|&nbsp;<i class="fas fa-users"></i>&nbsp;总访问人数:&nbsp;
                    <span id="busuanzi_value_site_uv" class="white-color"></span>
            </span>
            
            <br>

            <!-- 运行天数提醒. -->
            
            <br>
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">
    <a href="https://github.com/alexandermucc" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50">
        <i class="fab fa-github"></i>
    </a>















    <a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS 订阅" data-position="top" data-delay="50">
        <i class="fas fa-rss"></i>
    </a>

</div>
    </div>
</footer>

<div class="progress-bar"></div>


    <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;搜索</span>
            <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script type="text/javascript">
$(function () {
    var searchFunc = function (path, search_id, content_id) {
        'use strict';
        $.ajax({
            url: path,
            dataType: "xml",
            success: function (xmlResponse) {
                // get the contents from search data
                var datas = $("entry", xmlResponse).map(function () {
                    return {
                        title: $("title", this).text(),
                        content: $("content", this).text(),
                        url: $("url", this).text()
                    };
                }).get();
                var $input = document.getElementById(search_id);
                var $resultContent = document.getElementById(content_id);
                $input.addEventListener('input', function () {
                    var str = '<ul class=\"search-result-list\">';
                    var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                    $resultContent.innerHTML = "";
                    if (this.value.trim().length <= 0) {
                        return;
                    }
                    // perform local searching
                    datas.forEach(function (data) {
                        var isMatch = true;
                        var data_title = data.title.trim().toLowerCase();
                        var data_content = data.content.trim().replace(/<[^>]+>/g, "").toLowerCase();
                        var data_url = data.url;
                        data_url = data_url.indexOf('/') === 0 ? data.url : '/' + data_url;
                        var index_title = -1;
                        var index_content = -1;
                        var first_occur = -1;
                        // only match artiles with not empty titles and contents
                        if (data_title !== '' && data_content !== '') {
                            keywords.forEach(function (keyword, i) {
                                index_title = data_title.indexOf(keyword);
                                index_content = data_content.indexOf(keyword);
                                if (index_title < 0 && index_content < 0) {
                                    isMatch = false;
                                } else {
                                    if (index_content < 0) {
                                        index_content = 0;
                                    }
                                    if (i === 0) {
                                        first_occur = index_content;
                                    }
                                }
                            });
                        }
                        // show search results
                        if (isMatch) {
                            str += "<li><a href='" + data_url + "' class='search-result-title'>" + data_title + "</a>";
                            var content = data.content.trim().replace(/<[^>]+>/g, "");
                            if (first_occur >= 0) {
                                // cut out 100 characters
                                var start = first_occur - 20;
                                var end = first_occur + 80;
                                if (start < 0) {
                                    start = 0;
                                }
                                if (start === 0) {
                                    end = 100;
                                }
                                if (end > content.length) {
                                    end = content.length;
                                }
                                var match_content = content.substr(start, end);
                                // highlight all keywords
                                keywords.forEach(function (keyword) {
                                    var regS = new RegExp(keyword, "gi");
                                    match_content = match_content.replace(regS, "<em class=\"search-keyword\">" + keyword + "</em>");
                                });

                                str += "<p class=\"search-result\">" + match_content + "...</p>"
                            }
                            str += "</li>";
                        }
                    });
                    str += "</ul>";
                    $resultContent.innerHTML = str;
                });
            }
        });
    };

    searchFunc('/search.xml', 'searchInput', 'searchResult');
});
</script>

    <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="/libs/aos/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.js"></script>

    

    

    <!-- 雪花特效 -->
    

    <!-- 鼠标星星特效 -->
    

     
        <script src="https://ssl.captcha.qq.com/TCaptcha.js"></script>
        <script src="/libs/others/TencentCaptcha.js"></script>
        <button id="TencentCaptcha" data-appid="xxxxxxxxxx" data-cbfn="callback" type="button" hidden></button>
    

    <!-- Baidu Analytics -->

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    <script src="/libs/others/clicklove.js" async="async"></script>
    
    
    <script async src="/libs/others/busuanzi.pure.mini.js"></script>
    

    

    

    <!--腾讯兔小巢-->
    
    

    

    

    
    <script src="/libs/instantpage/instantpage.js" type="module"></script>
    

</body>

</html>
